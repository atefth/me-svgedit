{"ast":null,"code":"import _asyncToGenerator from \"C:/Projects/lib-workspace/node_modules/@angular-devkit/build-angular/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\n\n/**\n * @file ext-polystar.js\n *\n *\n * @copyright 2010 CloudCanvas, Inc. All rights reserved\n * @copyright 2021 Optimistik SAS, Inc. All rights reserved\n * @license MIT\n *\n */\nconst t = \"polystar\",\n      loadExtensionTranslation = /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator(function* (e) {\n    let l;\n    const s = e.configObj.pref(\"lang\");\n\n    try {\n      l = yield function __variableDynamicImportRuntime0__(t) {\n        switch (t) {\n          case \"./locale/en.js\":\n            return Promise.resolve().then(function () {\n              return o;\n            });\n\n          case \"./locale/fr.js\":\n            return Promise.resolve().then(function () {\n              return n;\n            });\n\n          case \"./locale/zh-CN.js\":\n            return Promise.resolve().then(function () {\n              return i;\n            });\n\n          default:\n            return new Promise(function (e, o) {\n              (\"function\" == typeof queueMicrotask ? queueMicrotask : setTimeout)(o.bind(null, new Error(\"Unknown variable dynamic import: \" + t)));\n            });\n        }\n      }(\"./locale/\".concat(s, \".js\"));\n    } catch (e) {\n      console.warn(\"Missing translation (\".concat(s, \") for \").concat(t, \" - using 'en'\")), l = yield Promise.resolve().then(function () {\n        return o;\n      });\n    }\n\n    e.i18next.addResourceBundle(s, t, l.default);\n  });\n\n  return function loadExtensionTranslation(_x) {\n    return _ref.apply(this, arguments);\n  };\n}();\n\nvar e = {\n  name: t,\n\n  init() {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      const e = _this,\n            {\n        svgCanvas: o\n      } = e,\n            {\n        ChangeElementCommand: n\n      } = o.history,\n            addToHistory = t => {\n        o.undoMgr.addCommandToHistory(t);\n      },\n            {\n        $id: i\n      } = o;\n\n      let l, s, a;\n      yield loadExtensionTranslation(e);\n\n      const showPanel = (t, e) => {\n        t ? i(\"\".concat(e, \"_panel\")).style.removeProperty(\"display\") : i(\"\".concat(e, \"_panel\")).style.display = \"none\";\n      },\n            setAttr = (t, e) => {\n        o.changeSelectedAttribute(t, e), o.call(\"changed\", l);\n      },\n            cot = t => 1 / Math.tan(t),\n            sec = t => 1 / Math.cos(t);\n\n      return {\n        name: e.i18next.t(\"\".concat(t, \":name\")),\n\n        callback() {\n          const e = \"\".concat(t, \":title\"),\n                s = \"\".concat(t, \":buttons.0.title\"),\n                a = \"\".concat(t, \":buttons.1.title\"),\n                r = '\\n            <se-flyingbutton id=\"tools_polygon\" title=\"'.concat(e, '\">\\n              <se-button id=\"tool_star\" title=\"').concat(s, '\" src=\"star.svg\">\\n              </se-button>\\n              <se-button id=\"tool_polygon\" title=\"').concat(a, '\" src=\"polygon.svg\">\\n              </se-button>\\n            </se-flyingbutton>\\n          ');\n          o.insertChildAtIndex(i(\"tools_left\"), r, 10), i(\"tool_star\").addEventListener(\"click\", () => {\n            this.leftPanel.updateLeftPanel(\"tool_star\") && (o.setMode(\"star\"), showPanel(!0, \"star\"), showPanel(!1, \"polygon\"));\n          }), i(\"tool_polygon\").addEventListener(\"click\", () => {\n            this.leftPanel.updateLeftPanel(\"tool_polygon\") && (o.setMode(\"polygon\"), showPanel(!0, \"polygon\"), showPanel(!1, \"star\"));\n          });\n          const c = \"\".concat(t, \":contextTools.0.label\"),\n                u = \"\".concat(t, \":contextTools.0.title\"),\n                d = \"\".concat(t, \":contextTools.1.label\"),\n                g = \"\".concat(t, \":contextTools.1.title\"),\n                p = \"\".concat(t, \":contextTools.2.label\"),\n                b = \"\".concat(t, \":contextTools.2.title\"),\n                h = \"\".concat(t, \":contextTools.3.label\"),\n                m = \"\".concat(t, \":contextTools.3.title\"),\n                f = document.createElement(\"template\");\n          f.innerHTML = '\\n          <div id=\"star_panel\">\\n            <se-spin-input id=\"starNumPoints\" label=\"'.concat(c, '\" min=1 step=1 value=5 title=\"').concat(u, '\">\\n            </se-spin-input>\\n            <se-spin-input id=\"RadiusMultiplier\" label=\"').concat(d, '\" min=1 step=2.5 value=3 title=\"').concat(g, '\">\\n            </se-spin-input>\\n            <se-spin-input id=\"radialShift\" min=0 step=1 value=0 label=\"').concat(p, '\" title=\"').concat(b, '\">\\n            </se-spin-input>\\n          </div>\\n          <div id=\"polygon_panel\">\\n            <se-spin-input size=\"3\" id=\"polySides\" min=1 step=1 value=5 label=\"').concat(h, '\" title=\"').concat(m, '\">\\n            </se-spin-input>\\n          </div>\\n        '), i(\"tools_top\").appendChild(f.content.cloneNode(!0)), showPanel(!1, \"star\"), showPanel(!1, \"polygon\"), i(\"starNumPoints\").addEventListener(\"change\", t => {\n            setAttr(\"point\", t.target.value);\n            const e = t.target.value;\n            let o = l.length;\n\n            for (; o--;) {\n              const t = l[o];\n\n              if (t.hasAttribute(\"r\")) {\n                const o = t.getAttribute(\"point\"),\n                      i = t.getAttribute(\"points\"),\n                      l = t.getAttribute(\"radialshift\");\n                let s = 0,\n                    a = 0;\n\n                if (t.points) {\n                  const r = t.points,\n                        c = r.numberOfItems;\n\n                  for (let t = 0; t < c; ++t) {\n                    const e = r.getItem(t);\n                    s += parseFloat(e.x), a += parseFloat(e.y);\n                  }\n\n                  const u = s / c,\n                        d = a / c,\n                        g = Number(t.getAttribute(\"r\")),\n                        p = g / t.getAttribute(\"starRadiusMultiplier\");\n                  let b = \"\";\n\n                  for (let t = 0; e >= t; t++) {\n                    let o = 2 * Math.PI * (t / e);\n                    o -= Math.PI / 2;\n                    let n = g * Math.cos(o) + u,\n                        i = g * Math.sin(o) + d;\n                    b += n + \",\" + i + \" \", isNaN(p) || (o = 2 * Math.PI * (t / e) + Math.PI / e, o -= Math.PI / 2, o += l, n = p * Math.cos(o) + u, i = p * Math.sin(o) + d, b += n + \",\" + i + \" \");\n                  }\n\n                  t.setAttribute(\"points\", b), addToHistory(new n(t, {\n                    point: o,\n                    points: i\n                  }));\n                }\n              }\n            }\n          }), i(\"RadiusMultiplier\").addEventListener(\"change\", t => {\n            setAttr(\"starRadiusMultiplier\", t.target.value);\n          }), i(\"radialShift\").addEventListener(\"change\", t => {\n            setAttr(\"radialshift\", t.target.value);\n          }), i(\"polySides\").addEventListener(\"change\", t => {\n            setAttr(\"sides\", t.target.value);\n            const e = t.target.value;\n            let o = l.length;\n\n            for (; o--;) {\n              const t = l[o];\n\n              if (t.hasAttribute(\"edge\")) {\n                const o = t.getAttribute(\"sides\"),\n                      i = t.getAttribute(\"points\");\n                let l = 0,\n                    s = 0;\n\n                if (t.points) {\n                  const a = t.points,\n                        r = a.numberOfItems;\n\n                  for (let t = 0; t < r; ++t) {\n                    const e = a.getItem(t);\n                    l += parseFloat(e.x), s += parseFloat(e.y);\n                  }\n\n                  const c = l / r,\n                        u = s / r,\n                        d = t.getAttribute(\"edge\") / 2 * cot(Math.PI / e) * sec(Math.PI / e);\n                  let g = \"\";\n\n                  for (let t = 0; e >= t; t++) {\n                    const o = 2 * Math.PI * t / e;\n                    g += d * Math.cos(o) + c + \",\" + (d * Math.sin(o) + u) + \" \";\n                  }\n\n                  t.setAttribute(\"points\", g), addToHistory(new n(t, {\n                    sides: o,\n                    points: i\n                  }));\n                }\n              }\n            }\n          });\n        },\n\n        mouseDown(t) {\n          if (\"star\" === o.getMode()) {\n            const e = o.getColor(\"fill\"),\n                  n = o.getColor(\"stroke\"),\n                  l = o.getStrokeWidth();\n            return s = !0, a = o.addSVGElementsFromJson({\n              element: \"polygon\",\n              attr: {\n                cx: t.start_x,\n                cy: t.start_y,\n                id: o.getNextId(),\n                shape: \"star\",\n                point: i(\"starNumPoints\").value,\n                r: 0,\n                radialshift: i(\"radialShift\").value,\n                r2: 0,\n                orient: \"point\",\n                fill: e,\n                strokecolor: n,\n                strokeWidth: l\n              }\n            }), {\n              started: !0\n            };\n          }\n\n          if (\"polygon\" === o.getMode()) {\n            const e = o.getColor(\"fill\"),\n                  n = o.getColor(\"stroke\"),\n                  l = o.getStrokeWidth();\n            return s = !0, a = o.addSVGElementsFromJson({\n              element: \"polygon\",\n              attr: {\n                cx: t.start_x,\n                cy: t.start_y,\n                id: o.getNextId(),\n                shape: \"regularPoly\",\n                sides: i(\"polySides\").value,\n                orient: \"x\",\n                edge: 0,\n                fill: e,\n                strokecolor: n,\n                strokeWidth: l\n              }\n            }), {\n              started: !0\n            };\n          }\n        },\n\n        mouseMove(t) {\n          if (s) {\n            if (\"star\" === o.getMode()) {\n              const e = Number(a.getAttribute(\"cx\")),\n                    o = Number(a.getAttribute(\"cy\")),\n                    n = Number(a.getAttribute(\"point\")),\n                    i = a.getAttribute(\"orient\"),\n                    l = a.getAttribute(\"fill\"),\n                    s = a.getAttribute(\"strokecolor\"),\n                    r = Number(a.getAttribute(\"strokeWidth\")),\n                    c = Number(a.getAttribute(\"radialshift\"));\n              let u = t.mouse_x,\n                  d = t.mouse_y;\n              const g = Math.sqrt((u - e) * (u - e) + (d - o) * (d - o)) / 1.5,\n                    p = document.getElementById(\"RadiusMultiplier\").value,\n                    b = g / p;\n              a.setAttribute(\"r\", g), a.setAttribute(\"r2\", b), a.setAttribute(\"starRadiusMultiplier\", p);\n              let h = \"\";\n\n              for (let t = 0; n >= t; t++) {\n                let l = 2 * Math.PI * (t / n);\n                \"point\" === i ? l -= Math.PI / 2 : \"edge\" === i && (l = l + Math.PI / n - Math.PI / 2), u = g * Math.cos(l) + e, d = g * Math.sin(l) + o, h += u + \",\" + d + \" \", isNaN(b) || (l = 2 * Math.PI * (t / n) + Math.PI / n, \"point\" === i ? l -= Math.PI / 2 : \"edge\" === i && (l = l + Math.PI / n - Math.PI / 2), l += c, u = b * Math.cos(l) + e, d = b * Math.sin(l) + o, h += u + \",\" + d + \" \");\n              }\n\n              return a.setAttribute(\"points\", h), a.setAttribute(\"fill\", l), a.setAttribute(\"stroke\", s), a.setAttribute(\"stroke-width\", r), a.getAttribute(\"shape\"), {\n                started: !0\n              };\n            }\n\n            if (\"polygon\" === o.getMode()) {\n              const e = Number(a.getAttribute(\"cx\")),\n                    o = Number(a.getAttribute(\"cy\")),\n                    n = Number(a.getAttribute(\"sides\")),\n                    i = a.getAttribute(\"fill\"),\n                    l = a.getAttribute(\"strokecolor\"),\n                    s = Number(a.getAttribute(\"strokeWidth\"));\n              let r = t.mouse_x,\n                  c = t.mouse_y;\n              const u = Math.sqrt((r - e) * (r - e) + (c - o) * (c - o)) / 1.5;\n              a.setAttribute(\"edge\", u);\n              const d = u / 2 * cot(Math.PI / n) * sec(Math.PI / n);\n              let g = \"\";\n\n              for (let t = 0; n >= t; t++) {\n                const i = 2 * Math.PI * t / n;\n                r = d * Math.cos(i) + e, c = d * Math.sin(i) + o, g += r + \",\" + c + \" \";\n              }\n\n              return a.setAttribute(\"points\", g), a.setAttribute(\"fill\", i), a.setAttribute(\"stroke\", l), a.setAttribute(\"stroke-width\", s), {\n                started: !0\n              };\n            }\n          }\n        },\n\n        mouseUp() {\n          if (\"star\" === o.getMode()) {\n            return {\n              keep: \"0\" !== a.getAttribute(\"r\"),\n              element: a\n            };\n          }\n\n          if (\"polygon\" === o.getMode()) {\n            return {\n              keep: \"0\" !== a.getAttribute(\"edge\"),\n              element: a\n            };\n          }\n        },\n\n        selectedChanged(t) {\n          l = t.elems;\n          let e = l.length;\n\n          for (; e--;) {\n            const o = l[e];\n            o && \"star\" === o.getAttribute(\"shape\") ? t.selectedElement && !t.multiselected ? (i(\"starNumPoints\").value = o.getAttribute(\"point\"), i(\"radialShift\").value = o.getAttribute(\"radialshift\"), showPanel(!0, \"star\")) : showPanel(!1, \"star\") : o && \"regularPoly\" === o.getAttribute(\"shape\") ? t.selectedElement && !t.multiselected ? (i(\"polySides\").value = o.getAttribute(\"sides\"), showPanel(!0, \"polygon\")) : showPanel(!1, \"polygon\") : (showPanel(!1, \"star\"), showPanel(!1, \"polygon\"));\n          }\n        }\n\n      };\n    })();\n  }\n\n},\n    o = Object.freeze({\n  __proto__: null,\n  default: {\n    name: \"star\",\n    title: \"Polygone/Star Tool\",\n    buttons: [{\n      title: \"Star Tool\"\n    }, {\n      title: \"Polygon Tool\"\n    }],\n    contextTools: [{\n      title: \"Number of Sides\",\n      label: \"points\"\n    }, {\n      title: \"Pointiness\",\n      label: \"Pointiness\"\n    }, {\n      title: \"Twists the star\",\n      label: \"Radial Shift\"\n    }, {\n      title: \"Number of Sides\",\n      label: \"sides\"\n    }]\n  }\n}),\n    n = Object.freeze({\n  __proto__: null,\n  default: {\n    name: \"etoile\",\n    title: \"Outil Polygone/Etoile\",\n    buttons: [{\n      title: \"Outil Etoile\"\n    }, {\n      title: \"Outil Polygone\"\n    }],\n    contextTools: [{\n      title: \"Nombre de côtés\",\n      label: \"points\"\n    }, {\n      title: \"Précision\",\n      label: \"Précision\"\n    }, {\n      title: \"Torsion Etoile\",\n      label: \"Décalage Radial\"\n    }, {\n      title: \"Nombre de côtés\",\n      label: \"côtés\"\n    }]\n  }\n}),\n    i = Object.freeze({\n  __proto__: null,\n  default: {\n    name: \"星形\",\n    title: \"Polygone/Star Tool\",\n    buttons: [{\n      title: \"星形工具\"\n    }, {\n      title: \"多边形工具\"\n    }],\n    contextTools: [{\n      title: \"顶点\",\n      label: \"顶点\"\n    }, {\n      title: \"钝度\",\n      label: \"钝度\"\n    }, {\n      title: \"径向\",\n      label: \"径向\"\n    }, {\n      title: \"边数\",\n      label: \"边数\"\n    }]\n  }\n});\nexport { e as default }; //# sourceMappingURL=ext-polystar.js.map","map":{"version":3,"sources":["C:/Projects/lib-workspace/node_modules/svgedit/dist/editor/extensions/ext-polystar/ext-polystar.js"],"names":["t","loadExtensionTranslation","e","l","s","configObj","pref","__variableDynamicImportRuntime0__","Promise","resolve","then","o","n","i","queueMicrotask","setTimeout","bind","Error","concat","console","warn","i18next","addResourceBundle","default","name","init","svgCanvas","ChangeElementCommand","history","addToHistory","undoMgr","addCommandToHistory","$id","a","showPanel","style","removeProperty","display","setAttr","changeSelectedAttribute","call","cot","Math","tan","sec","cos","callback","r","insertChildAtIndex","addEventListener","leftPanel","updateLeftPanel","setMode","c","u","d","g","p","b","h","m","f","document","createElement","innerHTML","appendChild","content","cloneNode","target","value","length","hasAttribute","getAttribute","points","numberOfItems","getItem","parseFloat","x","y","Number","PI","sin","isNaN","setAttribute","point","sides","mouseDown","getMode","getColor","getStrokeWidth","addSVGElementsFromJson","element","attr","cx","start_x","cy","start_y","id","getNextId","shape","radialshift","r2","orient","fill","strokecolor","strokeWidth","started","edge","mouseMove","mouse_x","mouse_y","sqrt","getElementById","mouseUp","keep","selectedChanged","elems","selectedElement","multiselected","Object","freeze","__proto__","title","buttons","contextTools","label"],"mappings":"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","sourcesContent":["/**\n * @file ext-polystar.js\n *\n *\n * @copyright 2010 CloudCanvas, Inc. All rights reserved\n * @copyright 2021 Optimistik SAS, Inc. All rights reserved\n * @license MIT\n *\n */\nconst t=\"polystar\",loadExtensionTranslation=async function(e){let l;const s=e.configObj.pref(\"lang\");try{l=await function __variableDynamicImportRuntime0__(t){switch(t){case\"./locale/en.js\":return Promise.resolve().then((function(){return o}));case\"./locale/fr.js\":return Promise.resolve().then((function(){return n}));case\"./locale/zh-CN.js\":return Promise.resolve().then((function(){return i}));default:return new Promise((function(e,o){(\"function\"==typeof queueMicrotask?queueMicrotask:setTimeout)(o.bind(null,new Error(\"Unknown variable dynamic import: \"+t)))}))}}(\"./locale/\".concat(s,\".js\"))}catch(e){console.warn(\"Missing translation (\".concat(s,\") for \").concat(t,\" - using 'en'\")),l=await Promise.resolve().then((function(){return o}))}e.i18next.addResourceBundle(s,t,l.default)};var e={name:t,async init(){const e=this,{svgCanvas:o}=e,{ChangeElementCommand:n}=o.history,addToHistory=t=>{o.undoMgr.addCommandToHistory(t)},{$id:i}=o;let l,s,a;await loadExtensionTranslation(e);const showPanel=(t,e)=>{t?i(\"\".concat(e,\"_panel\")).style.removeProperty(\"display\"):i(\"\".concat(e,\"_panel\")).style.display=\"none\"},setAttr=(t,e)=>{o.changeSelectedAttribute(t,e),o.call(\"changed\",l)},cot=t=>1/Math.tan(t),sec=t=>1/Math.cos(t);return{name:e.i18next.t(\"\".concat(t,\":name\")),callback(){const e=\"\".concat(t,\":title\"),s=\"\".concat(t,\":buttons.0.title\"),a=\"\".concat(t,\":buttons.1.title\"),r='\\n            <se-flyingbutton id=\"tools_polygon\" title=\"'.concat(e,'\">\\n              <se-button id=\"tool_star\" title=\"').concat(s,'\" src=\"star.svg\">\\n              </se-button>\\n              <se-button id=\"tool_polygon\" title=\"').concat(a,'\" src=\"polygon.svg\">\\n              </se-button>\\n            </se-flyingbutton>\\n          ');o.insertChildAtIndex(i(\"tools_left\"),r,10),i(\"tool_star\").addEventListener(\"click\",(()=>{this.leftPanel.updateLeftPanel(\"tool_star\")&&(o.setMode(\"star\"),showPanel(!0,\"star\"),showPanel(!1,\"polygon\"))})),i(\"tool_polygon\").addEventListener(\"click\",(()=>{this.leftPanel.updateLeftPanel(\"tool_polygon\")&&(o.setMode(\"polygon\"),showPanel(!0,\"polygon\"),showPanel(!1,\"star\"))}));const c=\"\".concat(t,\":contextTools.0.label\"),u=\"\".concat(t,\":contextTools.0.title\"),d=\"\".concat(t,\":contextTools.1.label\"),g=\"\".concat(t,\":contextTools.1.title\"),p=\"\".concat(t,\":contextTools.2.label\"),b=\"\".concat(t,\":contextTools.2.title\"),h=\"\".concat(t,\":contextTools.3.label\"),m=\"\".concat(t,\":contextTools.3.title\"),f=document.createElement(\"template\");f.innerHTML='\\n          <div id=\"star_panel\">\\n            <se-spin-input id=\"starNumPoints\" label=\"'.concat(c,'\" min=1 step=1 value=5 title=\"').concat(u,'\">\\n            </se-spin-input>\\n            <se-spin-input id=\"RadiusMultiplier\" label=\"').concat(d,'\" min=1 step=2.5 value=3 title=\"').concat(g,'\">\\n            </se-spin-input>\\n            <se-spin-input id=\"radialShift\" min=0 step=1 value=0 label=\"').concat(p,'\" title=\"').concat(b,'\">\\n            </se-spin-input>\\n          </div>\\n          <div id=\"polygon_panel\">\\n            <se-spin-input size=\"3\" id=\"polySides\" min=1 step=1 value=5 label=\"').concat(h,'\" title=\"').concat(m,'\">\\n            </se-spin-input>\\n          </div>\\n        '),i(\"tools_top\").appendChild(f.content.cloneNode(!0)),showPanel(!1,\"star\"),showPanel(!1,\"polygon\"),i(\"starNumPoints\").addEventListener(\"change\",(t=>{setAttr(\"point\",t.target.value);const e=t.target.value;let o=l.length;for(;o--;){const t=l[o];if(t.hasAttribute(\"r\")){const o=t.getAttribute(\"point\"),i=t.getAttribute(\"points\"),l=t.getAttribute(\"radialshift\");let s=0,a=0;if(t.points){const r=t.points,c=r.numberOfItems;for(let t=0;t<c;++t){const e=r.getItem(t);s+=parseFloat(e.x),a+=parseFloat(e.y)}const u=s/c,d=a/c,g=Number(t.getAttribute(\"r\")),p=g/t.getAttribute(\"starRadiusMultiplier\");let b=\"\";for(let t=0;e>=t;t++){let o=2*Math.PI*(t/e);o-=Math.PI/2;let n=g*Math.cos(o)+u,i=g*Math.sin(o)+d;b+=n+\",\"+i+\" \",isNaN(p)||(o=2*Math.PI*(t/e)+Math.PI/e,o-=Math.PI/2,o+=l,n=p*Math.cos(o)+u,i=p*Math.sin(o)+d,b+=n+\",\"+i+\" \")}t.setAttribute(\"points\",b),addToHistory(new n(t,{point:o,points:i}))}}}})),i(\"RadiusMultiplier\").addEventListener(\"change\",(t=>{setAttr(\"starRadiusMultiplier\",t.target.value)})),i(\"radialShift\").addEventListener(\"change\",(t=>{setAttr(\"radialshift\",t.target.value)})),i(\"polySides\").addEventListener(\"change\",(t=>{setAttr(\"sides\",t.target.value);const e=t.target.value;let o=l.length;for(;o--;){const t=l[o];if(t.hasAttribute(\"edge\")){const o=t.getAttribute(\"sides\"),i=t.getAttribute(\"points\");let l=0,s=0;if(t.points){const a=t.points,r=a.numberOfItems;for(let t=0;t<r;++t){const e=a.getItem(t);l+=parseFloat(e.x),s+=parseFloat(e.y)}const c=l/r,u=s/r,d=t.getAttribute(\"edge\")/2*cot(Math.PI/e)*sec(Math.PI/e);let g=\"\";for(let t=0;e>=t;t++){const o=2*Math.PI*t/e;g+=d*Math.cos(o)+c+\",\"+(d*Math.sin(o)+u)+\" \"}t.setAttribute(\"points\",g),addToHistory(new n(t,{sides:o,points:i}))}}}}))},mouseDown(t){if(\"star\"===o.getMode()){const e=o.getColor(\"fill\"),n=o.getColor(\"stroke\"),l=o.getStrokeWidth();return s=!0,a=o.addSVGElementsFromJson({element:\"polygon\",attr:{cx:t.start_x,cy:t.start_y,id:o.getNextId(),shape:\"star\",point:i(\"starNumPoints\").value,r:0,radialshift:i(\"radialShift\").value,r2:0,orient:\"point\",fill:e,strokecolor:n,strokeWidth:l}}),{started:!0}}if(\"polygon\"===o.getMode()){const e=o.getColor(\"fill\"),n=o.getColor(\"stroke\"),l=o.getStrokeWidth();return s=!0,a=o.addSVGElementsFromJson({element:\"polygon\",attr:{cx:t.start_x,cy:t.start_y,id:o.getNextId(),shape:\"regularPoly\",sides:i(\"polySides\").value,orient:\"x\",edge:0,fill:e,strokecolor:n,strokeWidth:l}}),{started:!0}}},mouseMove(t){if(s){if(\"star\"===o.getMode()){const e=Number(a.getAttribute(\"cx\")),o=Number(a.getAttribute(\"cy\")),n=Number(a.getAttribute(\"point\")),i=a.getAttribute(\"orient\"),l=a.getAttribute(\"fill\"),s=a.getAttribute(\"strokecolor\"),r=Number(a.getAttribute(\"strokeWidth\")),c=Number(a.getAttribute(\"radialshift\"));let u=t.mouse_x,d=t.mouse_y;const g=Math.sqrt((u-e)*(u-e)+(d-o)*(d-o))/1.5,p=document.getElementById(\"RadiusMultiplier\").value,b=g/p;a.setAttribute(\"r\",g),a.setAttribute(\"r2\",b),a.setAttribute(\"starRadiusMultiplier\",p);let h=\"\";for(let t=0;n>=t;t++){let l=2*Math.PI*(t/n);\"point\"===i?l-=Math.PI/2:\"edge\"===i&&(l=l+Math.PI/n-Math.PI/2),u=g*Math.cos(l)+e,d=g*Math.sin(l)+o,h+=u+\",\"+d+\" \",isNaN(b)||(l=2*Math.PI*(t/n)+Math.PI/n,\"point\"===i?l-=Math.PI/2:\"edge\"===i&&(l=l+Math.PI/n-Math.PI/2),l+=c,u=b*Math.cos(l)+e,d=b*Math.sin(l)+o,h+=u+\",\"+d+\" \")}return a.setAttribute(\"points\",h),a.setAttribute(\"fill\",l),a.setAttribute(\"stroke\",s),a.setAttribute(\"stroke-width\",r),a.getAttribute(\"shape\"),{started:!0}}if(\"polygon\"===o.getMode()){const e=Number(a.getAttribute(\"cx\")),o=Number(a.getAttribute(\"cy\")),n=Number(a.getAttribute(\"sides\")),i=a.getAttribute(\"fill\"),l=a.getAttribute(\"strokecolor\"),s=Number(a.getAttribute(\"strokeWidth\"));let r=t.mouse_x,c=t.mouse_y;const u=Math.sqrt((r-e)*(r-e)+(c-o)*(c-o))/1.5;a.setAttribute(\"edge\",u);const d=u/2*cot(Math.PI/n)*sec(Math.PI/n);let g=\"\";for(let t=0;n>=t;t++){const i=2*Math.PI*t/n;r=d*Math.cos(i)+e,c=d*Math.sin(i)+o,g+=r+\",\"+c+\" \"}return a.setAttribute(\"points\",g),a.setAttribute(\"fill\",i),a.setAttribute(\"stroke\",l),a.setAttribute(\"stroke-width\",s),{started:!0}}}},mouseUp(){if(\"star\"===o.getMode()){return{keep:\"0\"!==a.getAttribute(\"r\"),element:a}}if(\"polygon\"===o.getMode()){return{keep:\"0\"!==a.getAttribute(\"edge\"),element:a}}},selectedChanged(t){l=t.elems;let e=l.length;for(;e--;){const o=l[e];o&&\"star\"===o.getAttribute(\"shape\")?t.selectedElement&&!t.multiselected?(i(\"starNumPoints\").value=o.getAttribute(\"point\"),i(\"radialShift\").value=o.getAttribute(\"radialshift\"),showPanel(!0,\"star\")):showPanel(!1,\"star\"):o&&\"regularPoly\"===o.getAttribute(\"shape\")?t.selectedElement&&!t.multiselected?(i(\"polySides\").value=o.getAttribute(\"sides\"),showPanel(!0,\"polygon\")):showPanel(!1,\"polygon\"):(showPanel(!1,\"star\"),showPanel(!1,\"polygon\"))}}}}},o=Object.freeze({__proto__:null,default:{name:\"star\",title:\"Polygone/Star Tool\",buttons:[{title:\"Star Tool\"},{title:\"Polygon Tool\"}],contextTools:[{title:\"Number of Sides\",label:\"points\"},{title:\"Pointiness\",label:\"Pointiness\"},{title:\"Twists the star\",label:\"Radial Shift\"},{title:\"Number of Sides\",label:\"sides\"}]}}),n=Object.freeze({__proto__:null,default:{name:\"etoile\",title:\"Outil Polygone/Etoile\",buttons:[{title:\"Outil Etoile\"},{title:\"Outil Polygone\"}],contextTools:[{title:\"Nombre de côtés\",label:\"points\"},{title:\"Précision\",label:\"Précision\"},{title:\"Torsion Etoile\",label:\"Décalage Radial\"},{title:\"Nombre de côtés\",label:\"côtés\"}]}}),i=Object.freeze({__proto__:null,default:{name:\"星形\",title:\"Polygone/Star Tool\",buttons:[{title:\"星形工具\"},{title:\"多边形工具\"}],contextTools:[{title:\"顶点\",label:\"顶点\"},{title:\"钝度\",label:\"钝度\"},{title:\"径向\",label:\"径向\"},{title:\"边数\",label:\"边数\"}]}});export{e as default};\n//# sourceMappingURL=ext-polystar.js.map\n"]},"metadata":{},"sourceType":"module"}