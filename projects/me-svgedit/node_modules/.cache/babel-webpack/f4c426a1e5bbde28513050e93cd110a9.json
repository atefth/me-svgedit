{"ast":null,"code":"import _asyncToGenerator from \"C:/Projects/lib-workspace/node_modules/@angular-devkit/build-angular/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\n\n/**\n * @file ext-imagelib.js\n *\n * @license MIT\n *\n * @copyright 2010 Alexis Deveria\n *\n */\nconst e = \"imagelib\",\n      loadExtensionTranslation = /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator(function* (t) {\n    let d;\n    const b = t.configObj.pref(\"lang\");\n\n    try {\n      d = yield function __variableDynamicImportRuntime0__(e) {\n        switch (e) {\n          case \"./locale/de.js\":\n            return Promise.resolve().then(function () {\n              return i;\n            });\n\n          case \"./locale/en.js\":\n            return Promise.resolve().then(function () {\n              return n;\n            });\n\n          case \"./locale/fr.js\":\n            return Promise.resolve().then(function () {\n              return o;\n            });\n\n          case \"./locale/pl.js\":\n            return Promise.resolve().then(function () {\n              return r;\n            });\n\n          case \"./locale/pt-BR.js\":\n            return Promise.resolve().then(function () {\n              return s;\n            });\n\n          case \"./locale/ro.js\":\n            return Promise.resolve().then(function () {\n              return l;\n            });\n\n          case \"./locale/sk.js\":\n            return Promise.resolve().then(function () {\n              return a;\n            });\n\n          case \"./locale/sl.js\":\n            return Promise.resolve().then(function () {\n              return c;\n            });\n\n          case \"./locale/zh-CN.js\":\n            return Promise.resolve().then(function () {\n              return m;\n            });\n\n          default:\n            return new Promise(function (t, i) {\n              (\"function\" == typeof queueMicrotask ? queueMicrotask : setTimeout)(i.bind(null, new Error(\"Unknown variable dynamic import: \" + e)));\n            });\n        }\n      }(\"./locale/\".concat(b, \".js\"));\n    } catch (t) {\n      console.warn(\"Missing translation (\".concat(b, \") for \").concat(e, \" - using 'en'\")), d = yield Promise.resolve().then(function () {\n        return n;\n      });\n    }\n\n    t.i18next.addResourceBundle(b, e, d.default);\n  });\n\n  return function loadExtensionTranslation(_x) {\n    return _ref.apply(this, arguments);\n  };\n}();\n\nvar t = {\n  name: e,\n\n  init(t) {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      let {\n        decode64: i,\n        dropXMLInternalSubset: n\n      } = t;\n      const o = _this,\n            {\n        $id: r\n      } = o.svgCanvas,\n            {\n        $svgEditor: s\n      } = o,\n            {\n        imgPath: l\n      } = o.configObj.curConfig;\n      yield loadExtensionTranslation(o);\n\n      const {\n        svgCanvas: a\n      } = o,\n            c = [{\n        name: o.i18next.t(\"\".concat(e, \":imgLibs_0_name\")),\n        url: \"extensions/ext-imagelib/index.html\",\n        description: o.i18next.t(\"\".concat(e, \":imgLibs_0_description\"))\n      }, {\n        name: o.i18next.t(\"\".concat(e, \":imgLibs_1_name\")),\n        url: \"https://ian.umces.edu/symbols/catalog/svgedit/album_chooser.php?svgedit=3\",\n        description: o.i18next.t(\"\".concat(e, \":imgLibs_1_description\"))\n      }],\n            m = c.map(e => {\n        let {\n          url: t\n        } = e;\n\n        try {\n          return new URL(t).origin;\n        } catch (e) {\n          return location.origin;\n        }\n      }),\n            closeBrowser = () => {\n        r(\"imgbrowse_holder\").style.display = \"none\", document.activeElement.blur();\n      },\n            importImage = e => {\n        const t = a.addSVGElementsFromJson({\n          element: \"image\",\n          attr: {\n            x: 0,\n            y: 0,\n            width: 0,\n            height: 0,\n            id: a.getNextId(),\n            style: \"pointer-events:inherit\"\n          }\n        });\n        a.clearSelection(), a.addToSelection([t]), a.setImageURL(e);\n      },\n            d = {};\n\n      let b,\n          p,\n          u = \"s\",\n          g = [],\n          _ = !1;\n\n      window.addEventListener(\"message\", /*#__PURE__*/function () {\n        var _onMessage = _asyncToGenerator(function* (e) {\n          let t,\n              r,\n              s,\n              l,\n              c,\n              h,\n              {\n            origin: y,\n            data: f\n          } = e,\n              v = f;\n\n          if (v && [\"string\", \"object\"].includes(typeof v)) {\n            try {\n              if (v = \"object\" == typeof v ? v : JSON.parse(v), \"imagelib\" !== v.namespace) return;\n              if (!m.includes(\"*\") && !m.includes(y)) return void console.error(\"Origin \".concat(y, \" not whitelisted for posting to \").concat(window.origin));\n              const e = (\"name\" in v);\n              if (!e && _) return void (_ = !1);\n              \"href\" in v && (t = v.href, v = v.data), document.querySelector(\"se-elix-alert-dialog\") && document.querySelector(\"se-elix-alert-dialog\").remove(), r = e ? \"meta\" : v.charAt(0);\n            } catch (e) {\n              if (\"string\" == typeof v) {\n                const e = v.charAt(0);\n                if (\"{\" !== e && _) return void (_ = !1);\n\n                if (\"|\" === e) {\n                  const e = v.indexOf(\"|\", 1);\n                  t = v.substr(1, e - 1), v = v.substr(e + 1), r = v.charAt(0);\n                }\n              }\n            }\n\n            switch (r) {\n              case \"meta\":\n                {\n                  _ = !1, l = v, d[l.id] = l;\n                  const e = l.name || \"file\",\n                        t = o.i18next.t(\"notification.retrieving\").replace(\"%s\", e);\n                  return void (\"m\" !== u ? (yield seConfirm(t), _ = !0) : (s = document.createElement(\"div\"), s.textContent = t, s.dataset.id = l.id, b.appendChild(s), l.entry = s));\n                }\n\n              case \"<\":\n                c = !0;\n                break;\n\n              case \"d\":\n                if (v.startsWith(\"data:image/svg+xml\")) {\n                  const e = \"data:image/svg+xml;base64,\",\n                        t = v.substring(e.length);\n                  v = i(t), c = !0;\n                  break;\n                }\n\n                if (v.startsWith(\"data:image/\")) {\n                  h = !0;\n                  break;\n                }\n\n              default:\n                return void (\"m\" !== u ? closeBrowser() : d[t].entry.remove());\n            }\n\n            switch (u) {\n              case \"s\":\n                c ? o.svgCanvas.importSvgString(v) : h && importImage(v), closeBrowser();\n                break;\n\n              case \"m\":\n                {\n                  let e;\n\n                  if (g.push([c ? \"svg\" : \"img\", v]), l = d[t], c) {\n                    if (l && l.name) e = l.name;else {\n                      const t = new DOMParser().parseFromString(n(v), \"text/xml\").documentElement;\n                      e = t.querySelector(\"title\").textContent || \"(SVG #\" + v.length + \")\";\n                    }\n                    if (l) Array.from(b.children).forEach(function (i) {\n                      if (i.dataset.id === t) {\n                        if (l.preview_url) {\n                          const e = document.createElement(\"img\");\n                          e.src = l.preview_url;\n                          const t = document.createElement(\"span\");\n                          t.appendChild(e), i.append(t);\n                        } else i.textContent = e;\n\n                        p.removeAttribute(\"disabled\");\n                      }\n                    });else {\n                      const t = document.createElement(\"div\");\n                      t.textContent = e, b.appendChild(t), p.removeAttribute(\"disabled\");\n                    }\n                  } else {\n                    if (l && l.preview_url) {\n                      e = l.name || \"\", s = document.createElement(\"span\");\n                      const t = document.createElement(\"img\");\n                      t.src = l.preview_url, s.appendChild(t), s.appendChild(document.createTextNode(e));\n                    } else s = document.createElement(\"img\"), s.src = v;\n\n                    if (l) Array.from(b.children).forEach(function (e) {\n                      e.dataset.id === t && (e.appendChild(s), p.removeAttribute(\"disabled\"));\n                    });else {\n                      const e = document.createElement(\"div\");\n                      e.appendChild(s), b.appendChild(e), p.removeAttribute(\"disabled\");\n                    }\n                  }\n\n                  break;\n                }\n\n              case \"o\":\n                if (!c) break;\n                closeBrowser();\n                if (!(yield o.openPrep())) return;\n                a.clear(), a.setSvgString(v);\n                break;\n            }\n          }\n        });\n\n        function onMessage(_x2) {\n          return _onMessage.apply(this, arguments);\n        }\n\n        return onMessage;\n      }(), !0);\n\n      const insertAfter = (e, t) => {\n        e.parentNode.insertBefore(t, e.nextSibling);\n      },\n            toggleMultiLoop = () => {\n        for (g.forEach(function (e, t) {\n          const i = e[0],\n                n = e[1];\n          \"svg\" === i ? a.importSvgString(n) : importImage(n), a.moveSelectedElements(20 * t, 20 * t, !1);\n        }); b.firstChild;) b.removeChild(b.firstChild);\n\n        g = [], r(\"imgbrowse_holder\").style.display = \"none\";\n      },\n            toggleMulti = e => {\n        r(\"lib_framewrap\").style.right = e ? 200 : 10, r(\"imglib_opts\").style.right = e ? 200 : 10, b || (b = document.createElement(\"div\"), b.setAttribute(\"id\", \"imglib_preview\"), b.setAttribute(\"style\", \"position: absolute;top: 45px;right: 10px;width: 180px;bottom: 45px;background: #fff;overflow: auto;\"), insertAfter(r(\"lib_framewrap\"), b), p = document.createElement(\"button\"), p.setAttribute(\"content\", \"Import selected\"), p.setAttribute(\"disabled\", !0), p.textContent = \"Import selected\", p.setAttribute(\"style\", \"position: absolute;bottom: 10px;right: -10px;\"), r(\"imgbrowse\").appendChild(p), p.addEventListener(\"click\", toggleMultiLoop), p.addEventListener(\"touchend\", toggleMultiLoop)), p.style.display = e ? \"block\" : \"none\", b.style.display = e ? \"block\" : \"none\";\n      },\n            showBrowser = () => {\n        let t = r(\"imgbrowse\");\n        if (t) r(\"imgbrowse_holder\").style.display = \"block\";else {\n          const i = document.createElement(\"div\");\n          i.id = \"imgbrowse_holder\", i.innerHTML = \"<div id=imgbrowse class=toolbar_button></div>\", insertAfter(s, i), t = r(\"imgbrowse\");\n          const n = o.i18next.t(\"\".concat(e, \":select_lib\")),\n                a = document.createElement(\"div\");\n          a.id = \"lib_framewrap\";\n          const m = document.createElement(\"ul\");\n          m.id = \"imglib_opts\", t.append(m);\n          const d = document.createElement(\"iframe\");\n          d.src = \"javascript:0\", d.style.display = \"none\", a.append(d), t.prepend(a);\n          const b = document.createElement(\"h1\");\n          t.prepend(b), b.textContent = n, b.setAttribute(\"style\", \"position: absolute;top: 0px;left: 0px;width: 100%;\");\n          const p = document.createElement(\"button\");\n          p.innerHTML = o.i18next.t(\"common.cancel\"), t.appendChild(p), p.addEventListener(\"click\", function () {\n            r(\"imgbrowse_holder\").style.display = \"none\";\n          }), p.addEventListener(\"touchend\", function () {\n            r(\"imgbrowse_holder\").style.display = \"none\";\n          }), p.setAttribute(\"style\", \"position: absolute;top: 5px;right: 10px;\");\n          const g = document.createElement(\"span\");\n          g.setAttribute(\"style\", \"position: absolute;top: 5px;left: 10px;display: inline-flex;\"), t.appendChild(g);\n\n          const _ = document.createElement(\"button\");\n\n          _.style.visibility = \"hidden\", _.innerHTML = '<img class=\"svg_icon\" src=\"'.concat(l, '/library.svg\" alt=\"icon\" width=\"16\" height=\"16\" />') + o.i18next.t(\"\".concat(e, \":show_list\")), g.appendChild(_), _.addEventListener(\"click\", function () {\n            d.setAttribute(\"src\", \"about:blank\"), d.style.display = \"none\", m.style.display = \"block\", b.textContent = n, _.style.display = \"none\";\n          }), _.addEventListener(\"touchend\", function () {\n            d.setAttribute(\"src\", \"about:blank\"), d.style.display = \"none\", m.style.display = \"block\", b.textContent = n, _.style.display = \"none\";\n          }), _.setAttribute(\"style\", \"margin-right: 5px;\"), _.style.display = \"none\";\n          const h = document.createElement(\"select\");\n          h.innerHTML = \"<select><option value=s>\" + o.i18next.t(\"\".concat(e, \":import_single\")) + \"</option><option value=m>\" + o.i18next.t(\"\".concat(e, \":import_multi\")) + \"</option><option value=o>\" + o.i18next.t(\"\".concat(e, \":open\")) + \"</option>\", g.appendChild(h), h.addEventListener(\"change\", function () {\n            switch (u = this.value, u) {\n              case \"s\":\n              case \"o\":\n                toggleMulti(!1);\n                break;\n\n              case \"m\":\n                toggleMulti(!0);\n            }\n          }), h.setAttribute(\"style\", \"margin-top: 10px;\"), c.forEach(function (e) {\n            let {\n              name: t,\n              url: i,\n              description: n\n            } = e;\n            const o = document.createElement(\"li\");\n            m.appendChild(o), o.textContent = t, o.addEventListener(\"click\", function () {\n              d.setAttribute(\"src\", i), d.style.display = \"block\", b.textContent = t, m.style.display = \"none\", _.style.display = \"block\";\n            }), o.addEventListener(\"touchend\", function () {\n              d.setAttribute(\"src\", i), d.style.display = \"block\", b.textContent = t, m.style.display = \"none\", _.style.display = \"block\";\n            });\n            const r = document.createElement(\"span\");\n            r.textContent = n, o.appendChild(r);\n          });\n        }\n      };\n\n      return {\n        svgicons: \"ext-imagelib.xml\",\n\n        callback() {\n          const e = document.createElement(\"template\");\n          e.innerHTML = '\\n        <se-menu-item id=\"tool_imagelib\" label=\"'.concat(\"imagelib:buttons.0.title\", '\" src=\"library.svg\"></se-menu-item>\\n        '), insertAfter(r(\"tool_export\"), e.content.cloneNode(!0)), r(\"tool_imagelib\").addEventListener(\"click\", () => {\n            showBrowser();\n          });\n          const t = document.createElement(\"style\");\n          t.textContent = \"#imgbrowse_holder {position: absolute;top: 0;left: 0;width: 100%;height: 100%;background-color: rgba(0, 0, 0, .5);z-index: 5;}#imgbrowse {position: absolute;top: 25px;left: 25px;right: 25px;bottom: 25px;min-width: 300px;min-height: 200px;background: #5a6162;border: 1px outset #777;}#imgbrowse h1 {font-size: 20px;margin: .4em;text-align: center;}#lib_framewrap,#imgbrowse > ul {position: absolute;top: 45px;left: 10px;right: 10px;bottom: 10px;background: white;margin: 0;padding: 0;}#imgbrowse > ul {overflow: auto;}#imgbrowse > div {border: 1px solid #666;}#imglib_preview > div {padding: 5px;font-size: 12px;}#imglib_preview img {display: block;margin: 0 auto;max-height: 100px;}#imgbrowse li {list-style: none;padding: .5em;background: #E8E8E8;border-bottom: 1px solid #5a6162;line-height: 1.2em;font-style: sans-serif;}#imgbrowse li > span {color: #666;font-size: 15px;display: block;}#imgbrowse li:hover {background: #FFC;cursor: pointer;}#imgbrowse iframe {width: 100%;height: 100%;border: 0;}\", document.head.appendChild(t);\n        }\n\n      };\n    })();\n  }\n\n},\n    i = Object.freeze({\n  __proto__: null,\n  default: {\n    select_lib: \"Select an image library\",\n    show_list: \"Show library list\",\n    import_single: \"Import single\",\n    import_multi: \"Import multiple\",\n    open: \"Open as new document\",\n    buttons: [{\n      title: \"Bilder-Bibliothek\"\n    }],\n    imgLibs_0_name: \"Demo library (local)\",\n    imgLibs_0_description: \"Demonstration library for SVG-edit on this server\",\n    imgLibs_1_name: \"IAN Symbol Libraries\",\n    imgLibs_1_description: \"Free library of illustrations\"\n  }\n}),\n    n = Object.freeze({\n  __proto__: null,\n  default: {\n    select_lib: \"Select an image library\",\n    show_list: \"Show library list\",\n    import_single: \"Import single\",\n    import_multi: \"Import multiple\",\n    open: \"Open as new document\",\n    buttons: [{\n      title: \"Image library\"\n    }],\n    imgLibs_0_name: \"Demo library (local)\",\n    imgLibs_0_description: \"Demonstration library for SVG-edit on this server\",\n    imgLibs_1_name: \"IAN Symbol Libraries\",\n    imgLibs_1_description: \"Free library of illustrations\"\n  }\n}),\n    o = Object.freeze({\n  __proto__: null,\n  default: {\n    select_lib: \"Choisir une bibliothèque d'images\",\n    show_list: \"show_list\",\n    import_single: \"import_single\",\n    import_multi: \"import_multi\",\n    open: \"open\",\n    buttons: [{\n      title: \"Bibliothèque d'images\"\n    }],\n    imgLibs_0_name: \"Demo library (local)\",\n    imgLibs_0_description: \"Demonstration library for SVG-edit on this server\",\n    imgLibs_1_name: \"IAN Symbol Libraries\",\n    imgLibs_1_description: \"Free library of illustrations\"\n  }\n}),\n    r = Object.freeze({\n  __proto__: null,\n  default: {\n    select_lib: \"Select an image library\",\n    show_list: \"Show library list\",\n    import_single: \"Import single\",\n    import_multi: \"Import multiple\",\n    open: \"Open as new document\",\n    buttons: [{\n      title: \"Biblioteka obrazów\"\n    }],\n    imgLibs_0_name: \"Demo library (local)\",\n    imgLibs_0_description: \"Demonstration library for SVG-edit on this server\",\n    imgLibs_1_name: \"IAN Symbol Libraries\",\n    imgLibs_1_description: \"Free library of illustrations\"\n  }\n}),\n    s = Object.freeze({\n  __proto__: null,\n  default: {\n    select_lib: \"Select an image library\",\n    show_list: \"Show library list\",\n    import_single: \"Import single\",\n    import_multi: \"Import multiple\",\n    open: \"Open as new document\",\n    buttons: [{\n      title: \"Biblioteca de Imagens\"\n    }],\n    imgLibs_0_name: \"Demo library (local)\",\n    imgLibs_0_description: \"Demonstration library for SVG-edit on this server\",\n    imgLibs_1_name: \"IAN Symbol Libraries\",\n    imgLibs_1_description: \"Free library of illustrations\"\n  }\n}),\n    l = Object.freeze({\n  __proto__: null,\n  default: {\n    select_lib: \"Select an image library\",\n    show_list: \"Show library list\",\n    import_single: \"Import single\",\n    import_multi: \"Import multiple\",\n    open: \"Open as new document\",\n    buttons: [{\n      title: \"Bibliotecă de Imagini\"\n    }],\n    imgLibs_0_name: \"Demo library (local)\",\n    imgLibs_0_description: \"Demonstration library for SVG-edit on this server\",\n    imgLibs_1_name: \"IAN Symbol Libraries\",\n    imgLibs_1_description: \"Free library of illustrations\"\n  }\n}),\n    a = Object.freeze({\n  __proto__: null,\n  default: {\n    select_lib: \"Select an image library\",\n    show_list: \"Show library list\",\n    import_single: \"Import single\",\n    import_multi: \"Import multiple\",\n    open: \"Open as new document\",\n    buttons: [{\n      title: \"Knižnica obrázkov\"\n    }],\n    imgLibs_0_name: \"Demo library (local)\",\n    imgLibs_0_description: \"Demonstration library for SVG-edit on this server\",\n    imgLibs_1_name: \"IAN Symbol Libraries\",\n    imgLibs_1_description: \"Free library of illustrations\"\n  }\n}),\n    c = Object.freeze({\n  __proto__: null,\n  default: {\n    select_lib: \"Select an image library\",\n    show_list: \"Show library list\",\n    import_single: \"Import single\",\n    import_multi: \"Import multiple\",\n    open: \"Open as new document\",\n    buttons: [{\n      title: \"Knjižnica slik\"\n    }],\n    imgLibs_0_name: \"Demo library (local)\",\n    imgLibs_0_description: \"Demonstration library for SVG-edit on this server\",\n    imgLibs_1_name: \"IAN Symbol Libraries\",\n    imgLibs_1_description: \"Free library of illustrations\"\n  }\n}),\n    m = Object.freeze({\n  __proto__: null,\n  default: {\n    select_lib: \"Select an image library\",\n    show_list: \"Show library list\",\n    import_single: \"Import single\",\n    import_multi: \"Import multiple\",\n    open: \"Open as new document\",\n    buttons: [{\n      title: \"图像库\"\n    }],\n    imgLibs_0_name: \"Demo library (local)\",\n    imgLibs_0_description: \"Demonstration library for SVG-edit on this server\",\n    imgLibs_1_name: \"IAN Symbol Libraries\",\n    imgLibs_1_description: \"Free library of illustrations\"\n  }\n});\nexport { t as default }; //# sourceMappingURL=ext-imagelib.js.map","map":{"version":3,"sources":["C:/Projects/lib-workspace/node_modules/svgedit/dist/editor/extensions/ext-imagelib/ext-imagelib.js"],"names":["e","loadExtensionTranslation","t","d","b","configObj","pref","__variableDynamicImportRuntime0__","Promise","resolve","then","i","n","o","r","s","l","a","c","m","queueMicrotask","setTimeout","bind","Error","concat","console","warn","i18next","addResourceBundle","default","name","init","decode64","dropXMLInternalSubset","$id","svgCanvas","$svgEditor","imgPath","curConfig","url","description","map","URL","origin","location","closeBrowser","style","display","document","activeElement","blur","importImage","addSVGElementsFromJson","element","attr","x","y","width","height","id","getNextId","clearSelection","addToSelection","setImageURL","p","u","g","_","window","addEventListener","h","data","f","v","includes","JSON","parse","namespace","error","href","querySelector","remove","charAt","indexOf","substr","replace","seConfirm","createElement","textContent","dataset","appendChild","entry","startsWith","substring","length","importSvgString","push","DOMParser","parseFromString","documentElement","Array","from","children","forEach","preview_url","src","append","removeAttribute","createTextNode","openPrep","clear","setSvgString","onMessage","insertAfter","parentNode","insertBefore","nextSibling","toggleMultiLoop","moveSelectedElements","firstChild","removeChild","toggleMulti","right","setAttribute","showBrowser","innerHTML","prepend","visibility","value","svgicons","callback","content","cloneNode","head","Object","freeze","__proto__","select_lib","show_list","import_single","import_multi","open","buttons","title","imgLibs_0_name","imgLibs_0_description","imgLibs_1_name","imgLibs_1_description"],"mappings":"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","sourcesContent":["/**\n * @file ext-imagelib.js\n *\n * @license MIT\n *\n * @copyright 2010 Alexis Deveria\n *\n */\nconst e=\"imagelib\",loadExtensionTranslation=async function(t){let d;const b=t.configObj.pref(\"lang\");try{d=await function __variableDynamicImportRuntime0__(e){switch(e){case\"./locale/de.js\":return Promise.resolve().then((function(){return i}));case\"./locale/en.js\":return Promise.resolve().then((function(){return n}));case\"./locale/fr.js\":return Promise.resolve().then((function(){return o}));case\"./locale/pl.js\":return Promise.resolve().then((function(){return r}));case\"./locale/pt-BR.js\":return Promise.resolve().then((function(){return s}));case\"./locale/ro.js\":return Promise.resolve().then((function(){return l}));case\"./locale/sk.js\":return Promise.resolve().then((function(){return a}));case\"./locale/sl.js\":return Promise.resolve().then((function(){return c}));case\"./locale/zh-CN.js\":return Promise.resolve().then((function(){return m}));default:return new Promise((function(t,i){(\"function\"==typeof queueMicrotask?queueMicrotask:setTimeout)(i.bind(null,new Error(\"Unknown variable dynamic import: \"+e)))}))}}(\"./locale/\".concat(b,\".js\"))}catch(t){console.warn(\"Missing translation (\".concat(b,\") for \").concat(e,\" - using 'en'\")),d=await Promise.resolve().then((function(){return n}))}t.i18next.addResourceBundle(b,e,d.default)};var t={name:e,async init(t){let{decode64:i,dropXMLInternalSubset:n}=t;const o=this,{$id:r}=o.svgCanvas,{$svgEditor:s}=o,{imgPath:l}=o.configObj.curConfig;await loadExtensionTranslation(o);const{svgCanvas:a}=o,c=[{name:o.i18next.t(\"\".concat(e,\":imgLibs_0_name\")),url:\"extensions/ext-imagelib/index.html\",description:o.i18next.t(\"\".concat(e,\":imgLibs_0_description\"))},{name:o.i18next.t(\"\".concat(e,\":imgLibs_1_name\")),url:\"https://ian.umces.edu/symbols/catalog/svgedit/album_chooser.php?svgedit=3\",description:o.i18next.t(\"\".concat(e,\":imgLibs_1_description\"))}],m=c.map((e=>{let{url:t}=e;try{return new URL(t).origin}catch(e){return location.origin}})),closeBrowser=()=>{r(\"imgbrowse_holder\").style.display=\"none\",document.activeElement.blur()},importImage=e=>{const t=a.addSVGElementsFromJson({element:\"image\",attr:{x:0,y:0,width:0,height:0,id:a.getNextId(),style:\"pointer-events:inherit\"}});a.clearSelection(),a.addToSelection([t]),a.setImageURL(e)},d={};let b,p,u=\"s\",g=[],_=!1;window.addEventListener(\"message\",(async function onMessage(e){let t,r,s,l,c,h,{origin:y,data:f}=e,v=f;if(v&&[\"string\",\"object\"].includes(typeof v)){try{if(v=\"object\"==typeof v?v:JSON.parse(v),\"imagelib\"!==v.namespace)return;if(!m.includes(\"*\")&&!m.includes(y))return void console.error(\"Origin \".concat(y,\" not whitelisted for posting to \").concat(window.origin));const e=\"name\"in v;if(!e&&_)return void(_=!1);\"href\"in v&&(t=v.href,v=v.data),document.querySelector(\"se-elix-alert-dialog\")&&document.querySelector(\"se-elix-alert-dialog\").remove(),r=e?\"meta\":v.charAt(0)}catch(e){if(\"string\"==typeof v){const e=v.charAt(0);if(\"{\"!==e&&_)return void(_=!1);if(\"|\"===e){const e=v.indexOf(\"|\",1);t=v.substr(1,e-1),v=v.substr(e+1),r=v.charAt(0)}}}switch(r){case\"meta\":{_=!1,l=v,d[l.id]=l;const e=l.name||\"file\",t=o.i18next.t(\"notification.retrieving\").replace(\"%s\",e);return void(\"m\"!==u?(await seConfirm(t),_=!0):(s=document.createElement(\"div\"),s.textContent=t,s.dataset.id=l.id,b.appendChild(s),l.entry=s))}case\"<\":c=!0;break;case\"d\":if(v.startsWith(\"data:image/svg+xml\")){const e=\"data:image/svg+xml;base64,\",t=v.substring(e.length);v=i(t),c=!0;break}if(v.startsWith(\"data:image/\")){h=!0;break}default:return void(\"m\"!==u?closeBrowser():d[t].entry.remove())}switch(u){case\"s\":c?o.svgCanvas.importSvgString(v):h&&importImage(v),closeBrowser();break;case\"m\":{let e;if(g.push([c?\"svg\":\"img\",v]),l=d[t],c){if(l&&l.name)e=l.name;else{const t=(new DOMParser).parseFromString(n(v),\"text/xml\").documentElement;e=t.querySelector(\"title\").textContent||\"(SVG #\"+v.length+\")\"}if(l)Array.from(b.children).forEach((function(i){if(i.dataset.id===t){if(l.preview_url){const e=document.createElement(\"img\");e.src=l.preview_url;const t=document.createElement(\"span\");t.appendChild(e),i.append(t)}else i.textContent=e;p.removeAttribute(\"disabled\")}}));else{const t=document.createElement(\"div\");t.textContent=e,b.appendChild(t),p.removeAttribute(\"disabled\")}}else{if(l&&l.preview_url){e=l.name||\"\",s=document.createElement(\"span\");const t=document.createElement(\"img\");t.src=l.preview_url,s.appendChild(t),s.appendChild(document.createTextNode(e))}else s=document.createElement(\"img\"),s.src=v;if(l)Array.from(b.children).forEach((function(e){e.dataset.id===t&&(e.appendChild(s),p.removeAttribute(\"disabled\"))}));else{const e=document.createElement(\"div\");e.appendChild(s),b.appendChild(e),p.removeAttribute(\"disabled\")}}break}case\"o\":if(!c)break;closeBrowser();if(!await o.openPrep())return;a.clear(),a.setSvgString(v);break}}}),!0);const insertAfter=(e,t)=>{e.parentNode.insertBefore(t,e.nextSibling)},toggleMultiLoop=()=>{for(g.forEach((function(e,t){const i=e[0],n=e[1];\"svg\"===i?a.importSvgString(n):importImage(n),a.moveSelectedElements(20*t,20*t,!1)}));b.firstChild;)b.removeChild(b.firstChild);g=[],r(\"imgbrowse_holder\").style.display=\"none\"},toggleMulti=e=>{r(\"lib_framewrap\").style.right=e?200:10,r(\"imglib_opts\").style.right=e?200:10,b||(b=document.createElement(\"div\"),b.setAttribute(\"id\",\"imglib_preview\"),b.setAttribute(\"style\",\"position: absolute;top: 45px;right: 10px;width: 180px;bottom: 45px;background: #fff;overflow: auto;\"),insertAfter(r(\"lib_framewrap\"),b),p=document.createElement(\"button\"),p.setAttribute(\"content\",\"Import selected\"),p.setAttribute(\"disabled\",!0),p.textContent=\"Import selected\",p.setAttribute(\"style\",\"position: absolute;bottom: 10px;right: -10px;\"),r(\"imgbrowse\").appendChild(p),p.addEventListener(\"click\",toggleMultiLoop),p.addEventListener(\"touchend\",toggleMultiLoop)),p.style.display=e?\"block\":\"none\",b.style.display=e?\"block\":\"none\"},showBrowser=()=>{let t=r(\"imgbrowse\");if(t)r(\"imgbrowse_holder\").style.display=\"block\";else{const i=document.createElement(\"div\");i.id=\"imgbrowse_holder\",i.innerHTML=\"<div id=imgbrowse class=toolbar_button></div>\",insertAfter(s,i),t=r(\"imgbrowse\");const n=o.i18next.t(\"\".concat(e,\":select_lib\")),a=document.createElement(\"div\");a.id=\"lib_framewrap\";const m=document.createElement(\"ul\");m.id=\"imglib_opts\",t.append(m);const d=document.createElement(\"iframe\");d.src=\"javascript:0\",d.style.display=\"none\",a.append(d),t.prepend(a);const b=document.createElement(\"h1\");t.prepend(b),b.textContent=n,b.setAttribute(\"style\",\"position: absolute;top: 0px;left: 0px;width: 100%;\");const p=document.createElement(\"button\");p.innerHTML=o.i18next.t(\"common.cancel\"),t.appendChild(p),p.addEventListener(\"click\",(function(){r(\"imgbrowse_holder\").style.display=\"none\"})),p.addEventListener(\"touchend\",(function(){r(\"imgbrowse_holder\").style.display=\"none\"})),p.setAttribute(\"style\",\"position: absolute;top: 5px;right: 10px;\");const g=document.createElement(\"span\");g.setAttribute(\"style\",\"position: absolute;top: 5px;left: 10px;display: inline-flex;\"),t.appendChild(g);const _=document.createElement(\"button\");_.style.visibility=\"hidden\",_.innerHTML='<img class=\"svg_icon\" src=\"'.concat(l,'/library.svg\" alt=\"icon\" width=\"16\" height=\"16\" />')+o.i18next.t(\"\".concat(e,\":show_list\")),g.appendChild(_),_.addEventListener(\"click\",(function(){d.setAttribute(\"src\",\"about:blank\"),d.style.display=\"none\",m.style.display=\"block\",b.textContent=n,_.style.display=\"none\"})),_.addEventListener(\"touchend\",(function(){d.setAttribute(\"src\",\"about:blank\"),d.style.display=\"none\",m.style.display=\"block\",b.textContent=n,_.style.display=\"none\"})),_.setAttribute(\"style\",\"margin-right: 5px;\"),_.style.display=\"none\";const h=document.createElement(\"select\");h.innerHTML=\"<select><option value=s>\"+o.i18next.t(\"\".concat(e,\":import_single\"))+\"</option><option value=m>\"+o.i18next.t(\"\".concat(e,\":import_multi\"))+\"</option><option value=o>\"+o.i18next.t(\"\".concat(e,\":open\"))+\"</option>\",g.appendChild(h),h.addEventListener(\"change\",(function(){switch(u=this.value,u){case\"s\":case\"o\":toggleMulti(!1);break;case\"m\":toggleMulti(!0)}})),h.setAttribute(\"style\",\"margin-top: 10px;\"),c.forEach((function(e){let{name:t,url:i,description:n}=e;const o=document.createElement(\"li\");m.appendChild(o),o.textContent=t,o.addEventListener(\"click\",(function(){d.setAttribute(\"src\",i),d.style.display=\"block\",b.textContent=t,m.style.display=\"none\",_.style.display=\"block\"})),o.addEventListener(\"touchend\",(function(){d.setAttribute(\"src\",i),d.style.display=\"block\",b.textContent=t,m.style.display=\"none\",_.style.display=\"block\"}));const r=document.createElement(\"span\");r.textContent=n,o.appendChild(r)}))}};return{svgicons:\"ext-imagelib.xml\",callback(){const e=document.createElement(\"template\");e.innerHTML='\\n        <se-menu-item id=\"tool_imagelib\" label=\"'.concat(\"imagelib:buttons.0.title\",'\" src=\"library.svg\"></se-menu-item>\\n        '),insertAfter(r(\"tool_export\"),e.content.cloneNode(!0)),r(\"tool_imagelib\").addEventListener(\"click\",(()=>{showBrowser()}));const t=document.createElement(\"style\");t.textContent=\"#imgbrowse_holder {position: absolute;top: 0;left: 0;width: 100%;height: 100%;background-color: rgba(0, 0, 0, .5);z-index: 5;}#imgbrowse {position: absolute;top: 25px;left: 25px;right: 25px;bottom: 25px;min-width: 300px;min-height: 200px;background: #5a6162;border: 1px outset #777;}#imgbrowse h1 {font-size: 20px;margin: .4em;text-align: center;}#lib_framewrap,#imgbrowse > ul {position: absolute;top: 45px;left: 10px;right: 10px;bottom: 10px;background: white;margin: 0;padding: 0;}#imgbrowse > ul {overflow: auto;}#imgbrowse > div {border: 1px solid #666;}#imglib_preview > div {padding: 5px;font-size: 12px;}#imglib_preview img {display: block;margin: 0 auto;max-height: 100px;}#imgbrowse li {list-style: none;padding: .5em;background: #E8E8E8;border-bottom: 1px solid #5a6162;line-height: 1.2em;font-style: sans-serif;}#imgbrowse li > span {color: #666;font-size: 15px;display: block;}#imgbrowse li:hover {background: #FFC;cursor: pointer;}#imgbrowse iframe {width: 100%;height: 100%;border: 0;}\",document.head.appendChild(t)}}}},i=Object.freeze({__proto__:null,default:{select_lib:\"Select an image library\",show_list:\"Show library list\",import_single:\"Import single\",import_multi:\"Import multiple\",open:\"Open as new document\",buttons:[{title:\"Bilder-Bibliothek\"}],imgLibs_0_name:\"Demo library (local)\",imgLibs_0_description:\"Demonstration library for SVG-edit on this server\",imgLibs_1_name:\"IAN Symbol Libraries\",imgLibs_1_description:\"Free library of illustrations\"}}),n=Object.freeze({__proto__:null,default:{select_lib:\"Select an image library\",show_list:\"Show library list\",import_single:\"Import single\",import_multi:\"Import multiple\",open:\"Open as new document\",buttons:[{title:\"Image library\"}],imgLibs_0_name:\"Demo library (local)\",imgLibs_0_description:\"Demonstration library for SVG-edit on this server\",imgLibs_1_name:\"IAN Symbol Libraries\",imgLibs_1_description:\"Free library of illustrations\"}}),o=Object.freeze({__proto__:null,default:{select_lib:\"Choisir une bibliothèque d'images\",show_list:\"show_list\",import_single:\"import_single\",import_multi:\"import_multi\",open:\"open\",buttons:[{title:\"Bibliothèque d'images\"}],imgLibs_0_name:\"Demo library (local)\",imgLibs_0_description:\"Demonstration library for SVG-edit on this server\",imgLibs_1_name:\"IAN Symbol Libraries\",imgLibs_1_description:\"Free library of illustrations\"}}),r=Object.freeze({__proto__:null,default:{select_lib:\"Select an image library\",show_list:\"Show library list\",import_single:\"Import single\",import_multi:\"Import multiple\",open:\"Open as new document\",buttons:[{title:\"Biblioteka obrazów\"}],imgLibs_0_name:\"Demo library (local)\",imgLibs_0_description:\"Demonstration library for SVG-edit on this server\",imgLibs_1_name:\"IAN Symbol Libraries\",imgLibs_1_description:\"Free library of illustrations\"}}),s=Object.freeze({__proto__:null,default:{select_lib:\"Select an image library\",show_list:\"Show library list\",import_single:\"Import single\",import_multi:\"Import multiple\",open:\"Open as new document\",buttons:[{title:\"Biblioteca de Imagens\"}],imgLibs_0_name:\"Demo library (local)\",imgLibs_0_description:\"Demonstration library for SVG-edit on this server\",imgLibs_1_name:\"IAN Symbol Libraries\",imgLibs_1_description:\"Free library of illustrations\"}}),l=Object.freeze({__proto__:null,default:{select_lib:\"Select an image library\",show_list:\"Show library list\",import_single:\"Import single\",import_multi:\"Import multiple\",open:\"Open as new document\",buttons:[{title:\"Bibliotecă de Imagini\"}],imgLibs_0_name:\"Demo library (local)\",imgLibs_0_description:\"Demonstration library for SVG-edit on this server\",imgLibs_1_name:\"IAN Symbol Libraries\",imgLibs_1_description:\"Free library of illustrations\"}}),a=Object.freeze({__proto__:null,default:{select_lib:\"Select an image library\",show_list:\"Show library list\",import_single:\"Import single\",import_multi:\"Import multiple\",open:\"Open as new document\",buttons:[{title:\"Knižnica obrázkov\"}],imgLibs_0_name:\"Demo library (local)\",imgLibs_0_description:\"Demonstration library for SVG-edit on this server\",imgLibs_1_name:\"IAN Symbol Libraries\",imgLibs_1_description:\"Free library of illustrations\"}}),c=Object.freeze({__proto__:null,default:{select_lib:\"Select an image library\",show_list:\"Show library list\",import_single:\"Import single\",import_multi:\"Import multiple\",open:\"Open as new document\",buttons:[{title:\"Knjižnica slik\"}],imgLibs_0_name:\"Demo library (local)\",imgLibs_0_description:\"Demonstration library for SVG-edit on this server\",imgLibs_1_name:\"IAN Symbol Libraries\",imgLibs_1_description:\"Free library of illustrations\"}}),m=Object.freeze({__proto__:null,default:{select_lib:\"Select an image library\",show_list:\"Show library list\",import_single:\"Import single\",import_multi:\"Import multiple\",open:\"Open as new document\",buttons:[{title:\"图像库\"}],imgLibs_0_name:\"Demo library (local)\",imgLibs_0_description:\"Demonstration library for SVG-edit on this server\",imgLibs_1_name:\"IAN Symbol Libraries\",imgLibs_1_description:\"Free library of illustrations\"}});export{t as default};\n//# sourceMappingURL=ext-imagelib.js.map\n"]},"metadata":{},"sourceType":"module"}