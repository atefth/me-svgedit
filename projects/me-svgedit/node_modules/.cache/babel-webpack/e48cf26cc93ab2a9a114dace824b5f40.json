{"ast":null,"code":"import _asyncToGenerator from \"C:/Projects/lib-workspace/node_modules/@angular-devkit/build-angular/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\n\nvar e = Object.defineProperty,\n    u = (e, t) => () => (e && (t = e(e = 0)), t),\n    m = (t, i) => {\n  for (var s in (t => {\n    e(t, \"__esModule\", {\n      value: !0\n    });\n  })(t), i) e(t, s, {\n    get: i[s],\n    enumerable: !0\n  });\n},\n    t = {};\n\nm(t, {\n  default: () => i\n});\nvar i,\n    s = u(() => {\n  i = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator(function* () {\n      let e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : [{}];\n      return Array.isArray(e) || (e = [e]), new Promise((t, i) => {\n        let s = document.createElement(\"input\");\n        s.type = \"file\";\n        let o = [...e.map(e => e.mimeTypes || []).join(), e.map(e => e.extensions || []).join()].join();\n        s.multiple = e[0].multiple || !1, s.accept = o || \"\";\n\n        let a = e => {\n          \"function\" == typeof r && r(), t(e);\n        },\n            r = e[0].legacySetup && e[0].legacySetup(a, () => r(i), s);\n\n        s.addEventListener(\"change\", () => {\n          a(s.multiple ? Array.from(s.files) : s.files[0]);\n        }), s.click();\n      });\n    });\n\n    return function i() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n}),\n    o = {};\nm(o, {\n  default: () => c\n});\nvar r,\n    c,\n    d = u(() => {\n  r = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator(function* (e) {\n      let t = yield e.getFile();\n      return t.handle = e, t;\n    });\n\n    return function r(_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }(), c = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator(function* () {\n      let e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : [{}];\n      Array.isArray(e) || (e = [e]);\n      let t = [];\n      e.forEach((e, i) => {\n        t[i] = {\n          description: e.description || \"\",\n          accept: {}\n        }, e.mimeTypes ? e.mimeTypes.map(s => {\n          t[i].accept[s] = e.extensions || [];\n        }) : t[i].accept[\"*/*\"] = e.extensions || [];\n      });\n      let i = yield window.showOpenFilePicker({\n        id: e[0].id,\n        startIn: e[0].startIn,\n        types: t,\n        multiple: e[0].multiple || !1,\n        excludeAcceptAllOption: e[0].excludeAcceptAllOption || !1\n      }),\n          s = yield Promise.all(i.map(r));\n      return e[0].multiple ? s : s[0];\n    });\n\n    return function c() {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n}),\n    p = {};\nm(p, {\n  default: () => v\n});\nvar v,\n    g = u(() => {\n  v = /*#__PURE__*/function () {\n    var _ref4 = _asyncToGenerator(function* () {\n      let e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : [{}];\n      return Array.isArray(e) || (e = [e]), e[0].recursive = e[0].recursive || !1, new Promise((t, i) => {\n        let s = document.createElement(\"input\");\n        s.type = \"file\", s.webkitdirectory = !0;\n\n        let l = e => {\n          \"function\" == typeof o && o(), t(e);\n        },\n            o = e[0].legacySetup && e[0].legacySetup(l, () => o(i), s);\n\n        s.addEventListener(\"change\", () => {\n          let t = Array.from(s.files);\n          e[0].recursive ? e[0].recursive && e[0].skipDirectory && (t = t.filter(t => t.webkitRelativePath.split(\"/\").every(t => !e[0].skipDirectory({\n            name: t,\n            kind: \"directory\"\n          })))) : t = t.filter(e => 2 === e.webkitRelativePath.split(\"/\").length), l(t);\n        }), s.click();\n      });\n    });\n\n    return function v() {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n}),\n    f = {};\nm(f, {\n  default: () => y\n});\nvar h,\n    y,\n    w = u(() => {\n  h = /*#__PURE__*/function () {\n    var _ref5 = _asyncToGenerator(function* (e, t) {\n      let i = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : e.name,\n          s = arguments.length > 3 ? arguments[3] : void 0,\n          o = [],\n          r = [];\n\n      for await (let c of e.values()) {\n        let d = \"\".concat(i, \"/\").concat(c.name);\n        \"file\" === c.kind ? r.push(c.getFile().then(t => (t.directoryHandle = e, Object.defineProperty(t, \"webkitRelativePath\", {\n          configurable: !0,\n          enumerable: !0,\n          get: () => d\n        })))) : \"directory\" === c.kind && t && (!s || !s(c)) && o.push(h(c, t, d, s));\n      }\n\n      return [...(yield Promise.all(o)).flat(), ...(yield Promise.all(r))];\n    });\n\n    return function h(_x2, _x3) {\n      return _ref5.apply(this, arguments);\n    };\n  }(), y = /*#__PURE__*/function () {\n    var _ref6 = _asyncToGenerator(function* () {\n      let e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {};\n      e.recursive = e.recursive || !1;\n      let t = yield window.showDirectoryPicker({\n        id: e.id,\n        startIn: e.startIn\n      });\n      return h(t, e.recursive, void 0, e.skipDirectory);\n    });\n\n    return function y() {\n      return _ref6.apply(this, arguments);\n    };\n  }();\n}),\n    _ = {};\n\nfunction q(_x4, _x5) {\n  return _q.apply(this, arguments);\n}\n\nfunction _q() {\n  _q = _asyncToGenerator(function* (e, t) {\n    let i = e.getReader(),\n        s = new ReadableStream({\n      start: e => function () {\n        var _a = _asyncToGenerator(function* () {\n          return i.read().then(t => {\n            let {\n              done: i,\n              value: s\n            } = t;\n            if (!i) return e.enqueue(s), a();\n            e.close();\n          });\n        });\n\n        function a() {\n          return _a.apply(this, arguments);\n        }\n\n        return a;\n      }()()\n    }),\n        o = new Response(s);\n    return i.releaseLock(), new Blob([yield o.blob()], {\n      type: t\n    });\n  });\n  return _q.apply(this, arguments);\n}\n\nm(_, {\n  default: () => b\n});\nvar b,\n    A = u(() => {\n  b = /*#__PURE__*/function () {\n    var _ref7 = _asyncToGenerator(function* (e) {\n      let t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {};\n      Array.isArray(t) && (t = t[0]);\n      let i = document.createElement(\"a\"),\n          s = e;\n      \"body\" in e && (s = yield q(e.body, e.headers.get(\"content-type\"))), i.download = t.fileName || \"Untitled\", i.href = URL.createObjectURL(s);\n\n      let n = () => o(reject),\n          l = () => {\n        \"function\" == typeof o && o();\n      },\n          o = t.legacySetup && t.legacySetup(l, n, i);\n\n      return i.addEventListener(\"click\", () => {\n        setTimeout(() => URL.revokeObjectURL(i.href), 3e4), l();\n      }), i.click(), null;\n    });\n\n    return function b(_x6) {\n      return _ref7.apply(this, arguments);\n    };\n  }();\n}),\n    P = {};\nm(P, {\n  default: () => k\n});\n\nvar k,\n    S = u(() => {\n  k = /*#__PURE__*/function () {\n    var _ref8 = _asyncToGenerator(function* (e) {\n      let t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : [{}],\n          i = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : null,\n          s = arguments.length > 3 && void 0 !== arguments[3] && arguments[3];\n      Array.isArray(t) || (t = [t]), t[0].fileName = t[0].fileName || \"Untitled\";\n      let o = [];\n      if (t.forEach((t, i) => {\n        o[i] = {\n          description: t.description || \"\",\n          accept: {}\n        }, t.mimeTypes ? (0 === i && (e.type ? t.mimeTypes.push(e.type) : e.headers && e.headers.get(\"content-type\") && t.mimeTypes.push(e.headers.get(\"content-type\"))), t.mimeTypes.map(e => {\n          o[i].accept[e] = t.extensions || [];\n        })) : e.type && (o[i].accept[e.type] = t.extensions || []);\n      }), i) try {\n        yield i.getFile();\n      } catch (e) {\n        if (i = null, s) throw e;\n      }\n      let r = i || (yield window.showSaveFilePicker({\n        suggestedName: t[0].fileName,\n        id: t[0].id,\n        startIn: t[0].startIn,\n        types: o,\n        excludeAcceptAllOption: t[0].excludeAcceptAllOption || !1\n      })),\n          c = yield r.createWritable();\n      return \"stream\" in e ? (yield e.stream().pipeTo(c), r) : \"body\" in e ? (yield e.body.pipeTo(c), r) : (yield c.write(blob), yield c.close(), r);\n    });\n\n    return function k(_x7) {\n      return _ref8.apply(this, arguments);\n    };\n  }();\n}),\n    C = (() => {\n  if (\"undefined\" == typeof self) return !1;\n  if (\"top\" in self && self !== top) try {\n    top.location;\n  } catch {\n    return !1;\n  } else if (\"showOpenFilePicker\" in self) return \"showOpenFilePicker\";\n  return !1;\n})(),\n    x = C ? Promise.resolve().then(() => (d(), o)) : Promise.resolve().then(() => (s(), t));\n\nC ? Promise.resolve().then(() => (w(), f)) : Promise.resolve().then(() => (g(), p));\nvar E = C ? Promise.resolve().then(() => (S(), P)) : Promise.resolve().then(() => (A(), _));\n\nfunction G() {\n  return _G.apply(this, arguments);\n} // @license © 2020 Google LLC. Licensed under the Apache License, Version 2.0.\n\n\nfunction _G() {\n  _G = _asyncToGenerator(function* () {\n    return (yield E).default(...arguments);\n  });\n  return _G.apply(this, arguments);\n}\n\nconst O = \"opensave\";\nlet I = null;\n\nconst loadExtensionTranslation = /*#__PURE__*/function () {\n  var _ref9 = _asyncToGenerator(function* (e) {\n    let t;\n    const i = e.configObj.pref(\"lang\");\n\n    try {\n      t = yield function __variableDynamicImportRuntime0__(e) {\n        switch (e) {\n          case \"./locale/en.js\":\n            return Promise.resolve().then(function () {\n              return L;\n            });\n\n          case \"./locale/fr.js\":\n            return Promise.resolve().then(function () {\n              return T;\n            });\n\n          case \"./locale/zh-CN.js\":\n            return Promise.resolve().then(function () {\n              return R;\n            });\n\n          default:\n            return new Promise(function (t, i) {\n              (\"function\" == typeof queueMicrotask ? queueMicrotask : setTimeout)(i.bind(null, new Error(\"Unknown variable dynamic import: \" + e)));\n            });\n        }\n      }(\"./locale/\".concat(i, \".js\"));\n    } catch (e) {\n      console.warn(\"Missing translation (\".concat(i, \") for \").concat(O, \" - using 'en'\")), t = yield Promise.resolve().then(function () {\n        return L;\n      });\n    }\n\n    e.i18next.addResourceBundle(i, \"translation\", t.default, !0, !0);\n  });\n\n  return function loadExtensionTranslation(_x8) {\n    return _ref9.apply(this, arguments);\n  };\n}();\n\nvar j = {\n  name: O,\n\n  init(e) {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      const t = _this,\n            {\n        svgCanvas: i\n      } = t,\n            {\n        $id: s\n      } = i;\n      yield loadExtensionTranslation(t);\n\n      const importImage = e => {\n        s(\"se-prompt-dialog\").title = _this.i18next.t(\"notification.loadingImage\"), s(\"se-prompt-dialog\").setAttribute(\"close\", !1), e.stopPropagation(), e.preventDefault();\n        const t = \"drop\" === e.type ? e.dataTransfer.files[0] : e.currentTarget.files[0];\n        if (!t) return void s(\"se-prompt-dialog\").setAttribute(\"close\", !0);\n        if (!t.type.includes(\"image\")) return;\n        let i;\n        t.type.includes(\"svg\") ? (i = new FileReader(), i.onloadend = e => {\n          const t = _this.svgCanvas.importSvgString(e.target.result, !0);\n\n          _this.svgCanvas.alignSelectedElements(\"m\", \"page\"), _this.svgCanvas.alignSelectedElements(\"c\", \"page\"), _this.svgCanvas.selectOnly([t]), s(\"se-prompt-dialog\").setAttribute(\"close\", !0);\n        }, i.readAsText(t)) : (i = new FileReader(), i.onloadend = function (e) {\n          let {\n            target: {\n              result: t\n            }\n          } = e;\n\n          const insertNewImage = (e, i) => {\n            const o = this.svgCanvas.addSVGElementsFromJson({\n              element: \"image\",\n              attr: {\n                x: 0,\n                y: 0,\n                width: e,\n                height: i,\n                id: this.svgCanvas.getNextId(),\n                style: \"pointer-events:inherit\"\n              }\n            });\n            this.svgCanvas.setHref(o, t), this.svgCanvas.selectOnly([o]), this.svgCanvas.alignSelectedElements(\"m\", \"page\"), this.svgCanvas.alignSelectedElements(\"c\", \"page\"), this.topPanel.updateContextPanel(), s(\"se-prompt-dialog\").setAttribute(\"close\", !0);\n          };\n\n          let i = 100,\n              o = 100;\n          const r = new Image();\n          r.style.opacity = 0, r.addEventListener(\"load\", () => {\n            i = r.offsetWidth || r.naturalWidth || r.width, o = r.offsetHeight || r.naturalHeight || r.height, insertNewImage(i, o);\n          }), r.src = t;\n        }, i.readAsDataURL(t));\n      },\n            o = document.createElement(\"input\");\n\n      o.type = \"file\", o.addEventListener(\"change\", importImage), _this.workarea.addEventListener(\"drop\", importImage);\n\n      const clickClear = /*#__PURE__*/function () {\n        var _ref10 = _asyncToGenerator(function* () {\n          const [e, i] = t.configObj.curConfig.dimensions;\n          \"Cancel\" !== (yield seConfirm(t.i18next.t(\"notification.QwantToClear\"))) && (t.leftPanel.clickSelect(), t.svgCanvas.clear(), t.svgCanvas.setResolution(e, i), t.updateCanvas(!0), t.zoomImage(), t.layersPanel.populateLayers(), t.topPanel.updateContextPanel(), t.svgCanvas.runExtensions(\"onNewDocument\"));\n        });\n\n        return function clickClear() {\n          return _ref10.apply(this, arguments);\n        };\n      }(),\n            clickOpen = /*#__PURE__*/function () {\n        var _ref11 = _asyncToGenerator(function* () {\n          if (\"Cancel\" !== (yield t.openPrep())) {\n            i.clear();\n\n            try {\n              const e = yield function () {\n                var _M = _asyncToGenerator(function* () {\n                  return (yield x).default(...arguments);\n                });\n\n                function M() {\n                  return _M.apply(this, arguments);\n                }\n\n                return M;\n              }()({\n                mimeTypes: [\"image/*\"]\n              }),\n                    i = yield e.text();\n              yield t.loadSvgString(i), t.updateCanvas();\n            } catch (e) {\n              if (\"AbortError\" !== e.name) return console.error(e);\n            }\n          }\n        });\n\n        return function clickOpen() {\n          return _ref11.apply(this, arguments);\n        };\n      }(),\n            clickSave = /*#__PURE__*/function () {\n        var _ref12 = _asyncToGenerator(function* (e, o) {\n          if (\"open\" === s(\"se-svg-editor-dialog\").getAttribute(\"dialog\")) t.saveSourceEditor();else {\n            const s = {\n              images: t.configObj.pref(\"img_save\"),\n              round_digits: 6\n            };\n\n            if (i.clearSelection(), s) {\n              const e = i.mergeDeep(i.getSvgOption(), s);\n\n              for (const [t, s] of Object.entries(e)) i.setSvgOption(t, s);\n            }\n\n            i.setSvgOption(\"apply\", !0);\n\n            const o = '<?xml version=\"1.0\"?>\\n' + i.svgCanvasToString(),\n                  r = function (e) {\n              let t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : \"\",\n                  i = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : 512;\n              const s = atob(e),\n                    o = [];\n\n              for (let e = 0; e < s.length; e += i) {\n                const t = s.slice(e, e + i),\n                      r = new Array(t.length);\n\n                for (let e = 0; e < t.length; e++) r[e] = t.charCodeAt(e);\n\n                const c = new Uint8Array(r);\n                o.push(c);\n              }\n\n              return new Blob(o, {\n                type: t\n              });\n            }(i.encode64(o), \"image/svg+xml\");\n\n            try {\n              if (\"save\" === e && null !== I) {\n                const e = !1;\n                I = yield G(r, {\n                  fileName: \"icon.svg\",\n                  extensions: [\".svg\"]\n                }, I, e);\n              } else I = yield G(r, {\n                fileName: \"icon.svg\",\n                extensions: [\".svg\"]\n              });\n            } catch (e) {\n              if (\"AbortError\" !== e.name) return console.error(e);\n            }\n          }\n        });\n\n        return function clickSave(_x9, _x10) {\n          return _ref12.apply(this, arguments);\n        };\n      }();\n\n      return {\n        name: t.i18next.t(\"\".concat(O, \":name\")),\n\n        callback() {\n          i.insertChildAtIndex(s(\"main_button\"), '\\n        <se-menu-item id=\"tool_clear\" label=\"opensave.new_doc\" shortcut=\"N\" src=\"new.svg\"></se-menu-item>', 0);\n          i.insertChildAtIndex(s(\"main_button\"), '<se-menu-item id=\"tool_open\" label=\"opensave.open_image_doc\" src=\"open.svg\"></se-menu-item>', 1);\n          i.insertChildAtIndex(s(\"main_button\"), '<se-menu-item id=\"tool_save\" label=\"opensave.save_doc\" shortcut=\"S\" src=\"saveImg.svg\"></se-menu-item>', 2);\n          i.insertChildAtIndex(s(\"main_button\"), '<se-menu-item id=\"tool_save_as\" label=\"opensave.save_as_doc\" src=\"saveImg.svg\"></se-menu-item>', 3);\n          i.insertChildAtIndex(s(\"main_button\"), '<se-menu-item id=\"tool_import\" label=\"tools.import_doc\" src=\"importImg.svg\"></se-menu-item>', 4), s(\"tool_clear\").addEventListener(\"click\", clickClear.bind(this)), s(\"tool_open\").addEventListener(\"click\", clickOpen.bind(this)), s(\"tool_save\").addEventListener(\"click\", clickSave.bind(this, \"save\")), s(\"tool_save_as\").addEventListener(\"click\", clickSave.bind(this, \"saveas\")), s(\"tool_import\").addEventListener(\"click\", () => o.click());\n        }\n\n      };\n    })();\n  }\n\n},\n    L = Object.freeze({\n  __proto__: null,\n  default: {\n    opensave: {\n      new_doc: \"New Image\",\n      open_image_doc: \"Open SVG\",\n      save_doc: \"Save SVG\",\n      save_as_doc: \"Save as SVG\"\n    }\n  }\n}),\n    T = Object.freeze({\n  __proto__: null,\n  default: {\n    opensave: {\n      new_doc: \"Nouvelle image\",\n      open_image_doc: \"Ouvrir le SVG\",\n      save_doc: \"Enregistrer l'image\",\n      save_as_doc: \"Enregistrer en tant qu'image\"\n    }\n  }\n}),\n    R = Object.freeze({\n  __proto__: null,\n  default: {\n    opensave: {\n      new_doc: \"新图片\",\n      open_image_doc: \"打开 SVG\",\n      save_doc: \"保存图像\",\n      save_as_doc: \"另存为图像\"\n    }\n  }\n});\nexport { j as default }; //# sourceMappingURL=ext-opensave.js.map","map":{"version":3,"sources":["C:/Projects/lib-workspace/node_modules/svgedit/dist/editor/extensions/ext-opensave/ext-opensave.js"],"names":["e","Object","defineProperty","u","t","m","i","s","value","get","enumerable","default","arguments","length","Array","isArray","Promise","document","createElement","type","o","map","mimeTypes","join","extensions","multiple","accept","a","r","legacySetup","addEventListener","from","files","click","c","d","getFile","handle","forEach","description","window","showOpenFilePicker","id","startIn","types","excludeAcceptAllOption","all","p","v","g","recursive","webkitdirectory","l","skipDirectory","filter","webkitRelativePath","split","every","name","kind","f","y","h","w","values","concat","push","then","directoryHandle","configurable","flat","showDirectoryPicker","_","q","getReader","ReadableStream","start","read","done","enqueue","close","Response","releaseLock","Blob","blob","b","A","body","headers","download","fileName","href","URL","createObjectURL","n","reject","setTimeout","revokeObjectURL","P","k","S","showSaveFilePicker","suggestedName","createWritable","stream","pipeTo","write","C","self","top","location","x","resolve","E","G","O","I","loadExtensionTranslation","configObj","pref","__variableDynamicImportRuntime0__","L","T","R","queueMicrotask","bind","Error","console","warn","i18next","addResourceBundle","j","init","svgCanvas","$id","importImage","title","setAttribute","stopPropagation","preventDefault","dataTransfer","currentTarget","includes","FileReader","onloadend","importSvgString","target","result","alignSelectedElements","selectOnly","readAsText","insertNewImage","addSVGElementsFromJson","element","attr","width","height","getNextId","style","setHref","topPanel","updateContextPanel","Image","opacity","offsetWidth","naturalWidth","offsetHeight","naturalHeight","src","readAsDataURL","workarea","clickClear","curConfig","dimensions","seConfirm","leftPanel","clickSelect","clear","setResolution","updateCanvas","zoomImage","layersPanel","populateLayers","runExtensions","clickOpen","openPrep","M","text","loadSvgString","error","clickSave","getAttribute","saveSourceEditor","images","round_digits","clearSelection","mergeDeep","getSvgOption","entries","setSvgOption","svgCanvasToString","atob","slice","charCodeAt","Uint8Array","encode64","callback","insertChildAtIndex","freeze","__proto__","opensave","new_doc","open_image_doc","save_doc","save_as_doc"],"mappings":"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","sourcesContent":["var e=Object.defineProperty,u=(e,t)=>()=>(e&&(t=e(e=0)),t),m=(t,i)=>{for(var s in(t=>{e(t,\"__esModule\",{value:!0})})(t),i)e(t,s,{get:i[s],enumerable:!0})},t={};m(t,{default:()=>i});var i,s=u((()=>{i=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[{}];return Array.isArray(e)||(e=[e]),new Promise(((t,i)=>{let s=document.createElement(\"input\");s.type=\"file\";let o=[...e.map((e=>e.mimeTypes||[])).join(),e.map((e=>e.extensions||[])).join()].join();s.multiple=e[0].multiple||!1,s.accept=o||\"\";let a=e=>{\"function\"==typeof r&&r(),t(e)},r=e[0].legacySetup&&e[0].legacySetup(a,(()=>r(i)),s);s.addEventListener(\"change\",(()=>{a(s.multiple?Array.from(s.files):s.files[0])})),s.click()}))}})),o={};m(o,{default:()=>c});var r,c,d=u((()=>{r=async e=>{let t=await e.getFile();return t.handle=e,t},c=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[{}];Array.isArray(e)||(e=[e]);let t=[];e.forEach(((e,i)=>{t[i]={description:e.description||\"\",accept:{}},e.mimeTypes?e.mimeTypes.map((s=>{t[i].accept[s]=e.extensions||[]})):t[i].accept[\"*/*\"]=e.extensions||[]}));let i=await window.showOpenFilePicker({id:e[0].id,startIn:e[0].startIn,types:t,multiple:e[0].multiple||!1,excludeAcceptAllOption:e[0].excludeAcceptAllOption||!1}),s=await Promise.all(i.map(r));return e[0].multiple?s:s[0]}})),p={};m(p,{default:()=>v});var v,g=u((()=>{v=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[{}];return Array.isArray(e)||(e=[e]),e[0].recursive=e[0].recursive||!1,new Promise(((t,i)=>{let s=document.createElement(\"input\");s.type=\"file\",s.webkitdirectory=!0;let l=e=>{\"function\"==typeof o&&o(),t(e)},o=e[0].legacySetup&&e[0].legacySetup(l,(()=>o(i)),s);s.addEventListener(\"change\",(()=>{let t=Array.from(s.files);e[0].recursive?e[0].recursive&&e[0].skipDirectory&&(t=t.filter((t=>t.webkitRelativePath.split(\"/\").every((t=>!e[0].skipDirectory({name:t,kind:\"directory\"})))))):t=t.filter((e=>2===e.webkitRelativePath.split(\"/\").length)),l(t)})),s.click()}))}})),f={};m(f,{default:()=>y});var h,y,w=u((()=>{h=async function(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.name,s=arguments.length>3?arguments[3]:void 0,o=[],r=[];for await(let c of e.values()){let d=\"\".concat(i,\"/\").concat(c.name);\"file\"===c.kind?r.push(c.getFile().then((t=>(t.directoryHandle=e,Object.defineProperty(t,\"webkitRelativePath\",{configurable:!0,enumerable:!0,get:()=>d}))))):\"directory\"===c.kind&&t&&(!s||!s(c))&&o.push(h(c,t,d,s))}return[...(await Promise.all(o)).flat(),...await Promise.all(r)]},y=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.recursive=e.recursive||!1;let t=await window.showDirectoryPicker({id:e.id,startIn:e.startIn});return h(t,e.recursive,void 0,e.skipDirectory)}})),_={};async function q(e,t){let i=e.getReader(),s=new ReadableStream({start:e=>async function a(){return i.read().then((t=>{let{done:i,value:s}=t;if(!i)return e.enqueue(s),a();e.close()}))}()}),o=new Response(s);return i.releaseLock(),new Blob([await o.blob()],{type:t})}m(_,{default:()=>b});var b,A=u((()=>{b=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Array.isArray(t)&&(t=t[0]);let i=document.createElement(\"a\"),s=e;\"body\"in e&&(s=await q(e.body,e.headers.get(\"content-type\"))),i.download=t.fileName||\"Untitled\",i.href=URL.createObjectURL(s);let n=()=>o(reject),l=()=>{\"function\"==typeof o&&o()},o=t.legacySetup&&t.legacySetup(l,n,i);return i.addEventListener(\"click\",(()=>{setTimeout((()=>URL.revokeObjectURL(i.href)),3e4),l()})),i.click(),null}})),P={};m(P,{default:()=>k});var k,S=u((()=>{k=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[{}],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=arguments.length>3&&void 0!==arguments[3]&&arguments[3];Array.isArray(t)||(t=[t]),t[0].fileName=t[0].fileName||\"Untitled\";let o=[];if(t.forEach(((t,i)=>{o[i]={description:t.description||\"\",accept:{}},t.mimeTypes?(0===i&&(e.type?t.mimeTypes.push(e.type):e.headers&&e.headers.get(\"content-type\")&&t.mimeTypes.push(e.headers.get(\"content-type\"))),t.mimeTypes.map((e=>{o[i].accept[e]=t.extensions||[]}))):e.type&&(o[i].accept[e.type]=t.extensions||[])})),i)try{await i.getFile()}catch(e){if(i=null,s)throw e}let r=i||await window.showSaveFilePicker({suggestedName:t[0].fileName,id:t[0].id,startIn:t[0].startIn,types:o,excludeAcceptAllOption:t[0].excludeAcceptAllOption||!1}),c=await r.createWritable();return\"stream\"in e?(await e.stream().pipeTo(c),r):\"body\"in e?(await e.body.pipeTo(c),r):(await c.write(blob),await c.close(),r)}})),C=(()=>{if(\"undefined\"==typeof self)return!1;if(\"top\"in self&&self!==top)try{top.location}catch{return!1}else if(\"showOpenFilePicker\"in self)return\"showOpenFilePicker\";return!1})(),x=C?Promise.resolve().then((()=>(d(),o))):Promise.resolve().then((()=>(s(),t)));C?Promise.resolve().then((()=>(w(),f))):Promise.resolve().then((()=>(g(),p)));var E=C?Promise.resolve().then((()=>(S(),P))):Promise.resolve().then((()=>(A(),_)));async function G(){return(await E).default(...arguments)}\n// @license © 2020 Google LLC. Licensed under the Apache License, Version 2.0.\nconst O=\"opensave\";let I=null;const loadExtensionTranslation=async function(e){let t;const i=e.configObj.pref(\"lang\");try{t=await function __variableDynamicImportRuntime0__(e){switch(e){case\"./locale/en.js\":return Promise.resolve().then((function(){return L}));case\"./locale/fr.js\":return Promise.resolve().then((function(){return T}));case\"./locale/zh-CN.js\":return Promise.resolve().then((function(){return R}));default:return new Promise((function(t,i){(\"function\"==typeof queueMicrotask?queueMicrotask:setTimeout)(i.bind(null,new Error(\"Unknown variable dynamic import: \"+e)))}))}}(\"./locale/\".concat(i,\".js\"))}catch(e){console.warn(\"Missing translation (\".concat(i,\") for \").concat(O,\" - using 'en'\")),t=await Promise.resolve().then((function(){return L}))}e.i18next.addResourceBundle(i,\"translation\",t.default,!0,!0)};var j={name:O,async init(e){const t=this,{svgCanvas:i}=t,{$id:s}=i;await loadExtensionTranslation(t);const importImage=e=>{s(\"se-prompt-dialog\").title=this.i18next.t(\"notification.loadingImage\"),s(\"se-prompt-dialog\").setAttribute(\"close\",!1),e.stopPropagation(),e.preventDefault();const t=\"drop\"===e.type?e.dataTransfer.files[0]:e.currentTarget.files[0];if(!t)return void s(\"se-prompt-dialog\").setAttribute(\"close\",!0);if(!t.type.includes(\"image\"))return;let i;t.type.includes(\"svg\")?(i=new FileReader,i.onloadend=e=>{const t=this.svgCanvas.importSvgString(e.target.result,!0);this.svgCanvas.alignSelectedElements(\"m\",\"page\"),this.svgCanvas.alignSelectedElements(\"c\",\"page\"),this.svgCanvas.selectOnly([t]),s(\"se-prompt-dialog\").setAttribute(\"close\",!0)},i.readAsText(t)):(i=new FileReader,i.onloadend=function(e){let{target:{result:t}}=e;const insertNewImage=(e,i)=>{const o=this.svgCanvas.addSVGElementsFromJson({element:\"image\",attr:{x:0,y:0,width:e,height:i,id:this.svgCanvas.getNextId(),style:\"pointer-events:inherit\"}});this.svgCanvas.setHref(o,t),this.svgCanvas.selectOnly([o]),this.svgCanvas.alignSelectedElements(\"m\",\"page\"),this.svgCanvas.alignSelectedElements(\"c\",\"page\"),this.topPanel.updateContextPanel(),s(\"se-prompt-dialog\").setAttribute(\"close\",!0)};let i=100,o=100;const r=new Image;r.style.opacity=0,r.addEventListener(\"load\",(()=>{i=r.offsetWidth||r.naturalWidth||r.width,o=r.offsetHeight||r.naturalHeight||r.height,insertNewImage(i,o)})),r.src=t},i.readAsDataURL(t))},o=document.createElement(\"input\");o.type=\"file\",o.addEventListener(\"change\",importImage),this.workarea.addEventListener(\"drop\",importImage);const clickClear=async function(){const[e,i]=t.configObj.curConfig.dimensions;\"Cancel\"!==await seConfirm(t.i18next.t(\"notification.QwantToClear\"))&&(t.leftPanel.clickSelect(),t.svgCanvas.clear(),t.svgCanvas.setResolution(e,i),t.updateCanvas(!0),t.zoomImage(),t.layersPanel.populateLayers(),t.topPanel.updateContextPanel(),t.svgCanvas.runExtensions(\"onNewDocument\"))},clickOpen=async function(){if(\"Cancel\"!==await t.openPrep()){i.clear();try{const e=await async function M(){return(await x).default(...arguments)}({mimeTypes:[\"image/*\"]}),i=await e.text();await t.loadSvgString(i),t.updateCanvas()}catch(e){if(\"AbortError\"!==e.name)return console.error(e)}}},clickSave=async function(e,o){if(\"open\"===s(\"se-svg-editor-dialog\").getAttribute(\"dialog\"))t.saveSourceEditor();else{const s={images:t.configObj.pref(\"img_save\"),round_digits:6};if(i.clearSelection(),s){const e=i.mergeDeep(i.getSvgOption(),s);for(const[t,s]of Object.entries(e))i.setSvgOption(t,s)}i.setSvgOption(\"apply\",!0);const o='<?xml version=\"1.0\"?>\\n'+i.svgCanvasToString(),r=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:\"\",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:512;const s=atob(e),o=[];for(let e=0;e<s.length;e+=i){const t=s.slice(e,e+i),r=new Array(t.length);for(let e=0;e<t.length;e++)r[e]=t.charCodeAt(e);const c=new Uint8Array(r);o.push(c)}return new Blob(o,{type:t})}(i.encode64(o),\"image/svg+xml\");try{if(\"save\"===e&&null!==I){const e=!1;I=await G(r,{fileName:\"icon.svg\",extensions:[\".svg\"]},I,e)}else I=await G(r,{fileName:\"icon.svg\",extensions:[\".svg\"]})}catch(e){if(\"AbortError\"!==e.name)return console.error(e)}}};return{name:t.i18next.t(\"\".concat(O,\":name\")),callback(){i.insertChildAtIndex(s(\"main_button\"),'\\n        <se-menu-item id=\"tool_clear\" label=\"opensave.new_doc\" shortcut=\"N\" src=\"new.svg\"></se-menu-item>',0);i.insertChildAtIndex(s(\"main_button\"),'<se-menu-item id=\"tool_open\" label=\"opensave.open_image_doc\" src=\"open.svg\"></se-menu-item>',1);i.insertChildAtIndex(s(\"main_button\"),'<se-menu-item id=\"tool_save\" label=\"opensave.save_doc\" shortcut=\"S\" src=\"saveImg.svg\"></se-menu-item>',2);i.insertChildAtIndex(s(\"main_button\"),'<se-menu-item id=\"tool_save_as\" label=\"opensave.save_as_doc\" src=\"saveImg.svg\"></se-menu-item>',3);i.insertChildAtIndex(s(\"main_button\"),'<se-menu-item id=\"tool_import\" label=\"tools.import_doc\" src=\"importImg.svg\"></se-menu-item>',4),s(\"tool_clear\").addEventListener(\"click\",clickClear.bind(this)),s(\"tool_open\").addEventListener(\"click\",clickOpen.bind(this)),s(\"tool_save\").addEventListener(\"click\",clickSave.bind(this,\"save\")),s(\"tool_save_as\").addEventListener(\"click\",clickSave.bind(this,\"saveas\")),s(\"tool_import\").addEventListener(\"click\",(()=>o.click()))}}}},L=Object.freeze({__proto__:null,default:{opensave:{new_doc:\"New Image\",open_image_doc:\"Open SVG\",save_doc:\"Save SVG\",save_as_doc:\"Save as SVG\"}}}),T=Object.freeze({__proto__:null,default:{opensave:{new_doc:\"Nouvelle image\",open_image_doc:\"Ouvrir le SVG\",save_doc:\"Enregistrer l'image\",save_as_doc:\"Enregistrer en tant qu'image\"}}}),R=Object.freeze({__proto__:null,default:{opensave:{new_doc:\"新图片\",open_image_doc:\"打开 SVG\",save_doc:\"保存图像\",save_as_doc:\"另存为图像\"}}});export{j as default};\n//# sourceMappingURL=ext-opensave.js.map\n"]},"metadata":{},"sourceType":"module"}